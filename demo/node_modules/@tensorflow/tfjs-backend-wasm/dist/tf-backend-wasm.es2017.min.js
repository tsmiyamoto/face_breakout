/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@tensorflow/tfjs-core"),require("path"),require("fs"),require("worker_threads"),require("perf_hooks"),require("os")):"function"==typeof define&&define.amd?define(["exports","@tensorflow/tfjs-core","path","fs","worker_threads","perf_hooks","os"],t):t(((e=e||self).tf=e.tf||{},e.tf.wasm=e.tf.wasm||{}),e.tf,e.path,e.fs,e.worker_threads,e.perf_hooks,e.os)}(this,(function(e,t,n,a,r,s,u){"use strict";var i,o;let c;n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(i||(i={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(o||(o={}));const l={kernelName:t._FusedMatMul,backendName:"wasm",setupFunc:function(e){c=e.wasm.cwrap(t._FusedMatMul,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{a:r,b:s,bias:u,preluActivationWeights:i}=t;if("float32"!==r.dtype||"float32"!==s.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");const{transposeA:l,transposeB:d,activation:p,leakyreluAlpha:f}=a,m=n.dataIdMap.get(r.dataId).id,h=n.dataIdMap.get(s.dataId).id;let b=0;if(null!=u){const e=n.dataIdMap.get(u.dataId);if(1!==e.shape.length)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${e.shape.length}.`);b=e.id}const y=null==i?0:n.dataIdMap.get(i.dataId).id,_=o[p];if(null==_)throw new Error(`${p} activation not yet supported for FusedConv2D in the wasm backend.`);const g=l?r.shape[2]:r.shape[1],w=d?s.shape[1]:s.shape[2],k=r.shape[0],I=n.makeOutput([k,g,w],r.dtype),v=n.dataIdMap.get(I.dataId).id,S=new Uint8Array(new Int32Array(r.shape).buffer),A=new Uint8Array(new Int32Array(s.shape).buffer);return c(m,S,r.shape.length,h,A,s.shape.length,l,d,_,b,y,f||0,v),I}};function d(e,n){let a;return{kernelName:e,backendName:"wasm",setupFunc:function(t){a=t.wasm.cwrap(e,null,["number","number","number"])},kernelFunc:function(e){const{backend:r,inputs:{x:s}}=e,u=r.dataIdMap.get(s.dataId).id,o=r.makeOutput(s.shape,n||s.dtype),c=r.dataIdMap.get(o.dataId).id;return 0===t.util.sizeFromShape(o.shape)||a(u,i[s.dtype],c),o}}}const p=d(t.Abs);function f(e,n,a){let r;return{kernelName:e,backendName:"wasm",setupFunc:function(t){r=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(s){const{backend:u,inputs:o}=s,{a:c,b:l}=o,d=u.dataIdMap.get(c.dataId).id,p=u.dataIdMap.get(l.dataId).id,f=null!=a?a:c.dtype,m=t.backend_util.assertAndGetBroadcastShape(c.shape,l.shape),h=u.makeOutput(m,f);if(0===t.util.sizeFromShape(m))return h;const b=new Uint8Array(new Int32Array(c.shape).buffer),y=new Uint8Array(new Int32Array(l.shape).buffer),_=u.dataIdMap.get(h.dataId).id,g=()=>r(d,b,c.shape.length,p,y,l.shape.length,i[c.dtype],_);if(n&&"float32"===c.dtype)return g(),h;const w=t.backend_util.getBroadcastDims(c.shape,m),k=t.backend_util.getBroadcastDims(l.shape,m),I=w.every(((e,t)=>e===t)),v=k.every(((e,t)=>e===t));if(I&&v)return g(),h;throw new Error(`Broadcasting along outer dims is not yet supported for ${c.dtype} ${e}.`)}}}const m=f(t.Add,!0);let h;const b={kernelName:t.AddN,backendName:"wasm",setupFunc:function(e){h=e.wasm.cwrap(t.AddN,null,["array","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a}=e,r=a.makeOutput(n[0].shape,n[0].dtype);if(0===t.util.sizeFromShape(r.shape))return r;const s=n.map((e=>a.dataIdMap.get(e.dataId).id)),u=new Uint8Array(new Int32Array(s).buffer),o=a.dataIdMap.get(r.dataId).id;return h(u,s.length,i[r.dtype],o),r}};function y(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype),r=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(a).set(r),a}const _={kernelName:t.Identity,backendName:"wasm",kernelFunc:y};let g;function w(e){const{inputs:t,backend:n,attrs:a}=e,[r,s]=function(e,t){const n=[],a=[];for(let r=0;r<e.length;++r)1!==e[r]&&n.push(e[r]),1!==e[t[r]]&&a.push(t[r]);for(let e=0;e<a.length;++e){let t=-1;for(let n=0;n<a.length;++n)a[n]>=e&&(-1===t||a[t]>a[n])&&(t=n);a[t]=e}return[n,a]}(t.x.shape,a.perm);let u=!0;for(let e=0;e<s.length;e++)s[e]!==e&&(u=!1);const o=function(e,t){const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];return n}(t.x.shape,a.perm),c={dataId:t.x.dataId,shape:r,dtype:t.x.dtype};if(u){const e=y({inputs:t,backend:n});return e.shape=o,e}const l=n.makeOutput(o,c.dtype),d=n.dataIdMap.get(c.dataId).id,p=n.dataIdMap.get(l.dataId).id,f=new Uint8Array(new Int32Array(s).buffer),m=new Uint8Array(new Int32Array(c.shape).buffer);return g(d,m,c.shape.length,i[c.dtype],p,f,s.length),l}const k={kernelName:t.Transpose,backendName:"wasm",kernelFunc:w,setupFunc:function(e){g=e.wasm.cwrap(t.Transpose,null,["number","array","number","number","number","array","number"])}};function I(e,n,a){const r=e.shape,s=e.shape.length,u=t.util.parseAxisParam(n,r);let i=u;const o=t.backend_util.getAxesPermutation(i,s);let c=null,l=!1;if(null!=o){const n=new Array(s);for(let e=0;e<n.length;e++)n[e]=r[o[e]];i=t.backend_util.getInnerMostAxes(i.length,s),c=w({inputs:{x:e},attrs:{perm:o},backend:a});const u=a.dataIdMap.get(e.dataId).id;a.dataIdMap.get(c.dataId).id!==u&&(l=!0)}return{transposed:c,originalAxes:u,axes:i,inputWasTransposed:l}}let v;const S={kernelName:t.All,backendName:"wasm",setupFunc:function(e){v=e.wasm.cwrap(t.All,null,["number, number, number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a;let o=n.dataIdMap.get(i.dataId).id,c=i;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=I(i,s,n);if(f){c=l,o=n.dataIdMap.get(l.dataId).id}const m=c.shape.length;t.backend_util.assertAxesAreInnerMostDims("all",d,m);const[h,b]=t.backend_util.computeOutAndReduceShapes(c.shape,d),y=t.util.sizeFromShape(b),_=n.makeOutput(h,i.dtype);if(0!==t.util.sizeFromShape(c.shape)){const e=n.dataIdMap.get(_.dataId).id;v(o,y,e)}if(f&&n.disposeData(l.dataId),u){const e=t.backend_util.expandShapeToKeepDim(_.shape,p);_.shape=e}return _}};let A;const M={kernelName:t.Any,backendName:"wasm",setupFunc:function(e){A=e.wasm.cwrap(t.Any,null,["number, number, number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a;let o=n.dataIdMap.get(i.dataId).id,c=i;const{transposed:l,axes:d,originalAxes:p,inputWasTransposed:f}=I(i,s,n);if(f){c=l,o=n.dataIdMap.get(l.dataId).id}const m=c.shape.length;t.backend_util.assertAxesAreInnerMostDims("any",d,m);const[h,b]=t.backend_util.computeOutAndReduceShapes(c.shape,d),y=t.util.sizeFromShape(b),_=n.makeOutput(h,i.dtype);if(0!==t.util.sizeFromShape(c.shape)){const e=n.dataIdMap.get(_.dataId).id;A(o,y,e)}if(f&&n.disposeData(l.dataId),u){const e=t.backend_util.expandShapeToKeepDim(_.shape,p);_.shape=e}return _}};let E;const x={kernelName:t.ArgMax,backendName:"wasm",kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s}=r,{x:u}=a,o=n.dataIdMap.get(u.dataId).id;let c=o,l=u;const{transposed:d,axes:p,inputWasTransposed:f}=I(u,s,n);if(f){const e=n.dataIdMap.get(d.dataId).id;e!==o&&(l=d,c=e)}const m=l.shape.slice(0,-1),h=n.makeOutput(m,"int32"),b=n.dataIdMap.get(h.dataId).id,y=t.util.sizeFromShape(h.shape),_=l.shape[p[0]];return E(c,i[l.dtype],y,_,b),f&&n.disposeData(d.dataId),h},setupFunc:function(e){E=e.wasm.cwrap(t.ArgMax,null,["number","number","number","number","number"])}};let N;const F={kernelName:t.AvgPool,backendName:"wasm",setupFunc:function(e){N=e.wasm.cwrap(t.AvgPool,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,s=n.x,u=r.dataIdMap.get(s.dataId).id,{filterSize:i,strides:o,pad:c,dimRoundingMode:l}=a,d=t.backend_util.computePool2DInfo(s.shape,i,o,1,c,l),p=d.filterHeight,f=d.filterWidth,m=d.padInfo.top,h=d.padInfo.right,b=d.padInfo.bottom,y=d.padInfo.left,_=d.strideHeight,g=d.strideWidth,w=d.inChannels;if("channelsLast"!==d.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${d.dataFormat}'. Please use 'channelsLast'.`);if(1!==d.dilationWidth||1!==d.dilationHeight)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${d.dilationHeight}, ${d.dilationWidth}].`);const k=r.makeOutput(d.outShape,"float32"),I=r.dataIdMap.get(k.dataId).id;return N(u,s.shape[0],s.shape[1],s.shape[2],p,f,m,h,b,y,_,g,w,I),k}};function T(e){const{inputs:n,attrs:a}=e,{x:r}=n,{shape:s}=a,u=t.util.sizeFromShape(r.shape),i=t.util.inferFromImplicitShape(s,u);return t.util.assert(u===t.util.sizeFromShape(i),(()=>`new shape: ${i}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`)),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}const O={kernelName:t.Reshape,backendName:"wasm",kernelFunc:T};let C;const D={kernelName:t.BatchMatMul,backendName:"wasm",setupFunc:function(e){C=e.wasm.cwrap(t.BatchMatMul,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{a:s,b:u}=n,{transposeA:i,transposeB:o}=r;if("float32"!==s.dtype||"float32"!==u.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");const c=s.shape.length,l=u.shape.length,d=i?s.shape[c-2]:s.shape[c-1],p=o?u.shape[l-1]:u.shape[l-2],f=i?s.shape[c-1]:s.shape[c-2],m=o?u.shape[l-2]:u.shape[l-1],h=s.shape.slice(0,-2),b=u.shape.slice(0,-2),y=t.util.sizeFromShape(h),_=t.util.sizeFromShape(b),g=y===_||1===y||1===_;t.util.assert(c>=2&&l>=2&&g,(()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${h}) and (${b}).`));const w=(y>_?s.shape.slice(0,-2):u.shape.slice(0,-2)).concat([f,m]);t.util.assert(d===p,(()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${s.shape} and ${u.shape} and transposeA=${i} and transposeB=${o} must match.`));const k=o?[_,m,p]:[_,p,m],I=T({inputs:{x:s},backend:a,attrs:{shape:i?[y,d,f]:[y,f,d]}}),v=T({inputs:{x:u},backend:a,attrs:{shape:k}}),S=a.dataIdMap.get(I.dataId).id,A=a.dataIdMap.get(v.dataId).id,M=i?I.shape[2]:I.shape[1],E=o?v.shape[1]:v.shape[2],x=Math.max(y,_),N=a.makeOutput([x,M,E],I.dtype),F=a.dataIdMap.get(N.dataId).id,O=new Uint8Array(new Int32Array(I.shape).buffer),D=new Uint8Array(new Int32Array(v.shape).buffer);return C(S,O,I.shape.length,A,D,v.shape.length,i,o,F),a.disposeData(I.dataId),a.disposeData(v.dataId),N.shape=w,N}};function R(e,n,a,r,s){const u=t.slice_util.isSliceContinous(r,n,a),i=t.util.sizeFromShape(a),o=t.util.computeStrides(r);if(u){const a=t.slice_util.computeFlatOffset(n,o);return"string"===s?e.slice(a,a+i):e.subarray(a,a+i)}const c="string"===s?t.backend_util.fromUint8ToStringArray(e):e,l=t.buffer(r,s,c),d=t.buffer(a,s);for(let e=0;e<d.size;++e){const t=d.indexToLoc(e),a=t.map(((e,t)=>e+n[t]));d.set(l.get(...a),...t)}return"string"===s?t.backend_util.fromStringArrayToUint8(d.values):d.values}function P(e){const{inputs:{x:n},attrs:{begin:a,size:r},backend:s}=e,[u,i]=t.slice_util.parseSliceParams(n,a,r),o=t.slice_util.isSliceContinous(n.shape,u,i),c=s.readSync(n.dataId),l=s.makeOutput(i,n.dtype),d=t.util.computeStrides(n.shape),p=s.dataIdMap.get(l.dataId);if(o){const e=t.slice_util.computeFlatOffset(u,d);if("string"===n.dtype)p.stringBytes=c.slice(e,e+t.util.sizeFromShape(i));else{s.typedArrayFromHeap(l).set(c.subarray(e,e+t.util.sizeFromShape(i)))}return l}if("string"===n.dtype){const e=R(c,u,i,n.shape,n.dtype);return p.stringBytes=e,l}const f=s.typedArrayFromHeap(l),m=n.shape.length;if(2===m)!function(e,t,n,a,r){let s=0;const u=a[0],i=a[1],o=u+r[0];for(let a=u;a<o;a++){const u=a*t+i;n.set(e.subarray(u,u+r[1]),s),s+=r[1]}}(c,d[0],f,u,i);else if(3===m)!function(e,t,n,a,r,s){let u=0;const i=r[0],o=r[1],c=r[2],l=i+s[0],d=o+s[1];for(let r=i;r<l;r++)for(let i=o;i<d;i++){const o=r*t+i*n+c;a.set(e.subarray(o,o+s[2]),u),u+=s[2]}}(c,d[0],d[1],f,u,i);else if(4===m)!function(e,t,n,a,r,s,u){let i=0;const o=s[0],c=s[1],l=s[2],d=o+u[0],p=c+u[1],f=l+u[2],m=s[3];for(let s=o;s<d;s++)for(let o=c;o<p;o++)for(let c=l;c<f;c++){const l=s*t+o*n+c*a+m;r.set(e.subarray(l,l+u[3]),i),i+=u[3]}}(c,d[0],d[1],d[2],f,u,i);else{const e=R(c,u,i,n.shape,n.dtype);f.set(e)}return l}const W={kernelName:t.Slice,backendName:"wasm",kernelFunc:P};const L={kernelName:t.BatchToSpaceND,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{blockShape:u,crops:i}=r,o=u.reduce(((e,t)=>e*t)),c=t.backend_util.getReshaped(s.shape,u,o),l=t.backend_util.getPermuted(c.length,u.length),d=t.backend_util.getReshapedPermuted(s.shape,u,o),p=t.backend_util.getSliceBeginCoords(i,u.length),f=t.backend_util.getSliceSize(d,i,u.length),m=T({inputs:{x:s},backend:a,attrs:{shape:c}}),h=w({inputs:{x:m},backend:a,attrs:{perm:l}}),b=P({inputs:{x:T({inputs:{x:h},backend:a,attrs:{shape:d}})},backend:a,attrs:{begin:p,size:f}});return a.disposeData(m.dataId),a.disposeData(h.dataId),a.disposeData(m.dataId),b}};function H(e){const{inputs:{x:t},attrs:{dtype:n},backend:a}=e,r=a.makeOutput(t.shape,n),s=a.typedArrayFromHeap(t);return a.typedArrayFromHeap(r).set(s),r}const B={kernelName:t.Cast,backendName:"wasm",kernelFunc:H},U=d(t.Ceil);let z;const j={kernelName:t.ClipByValue,backendName:"wasm",setupFunc:function(e){z=e.wasm.cwrap(t.ClipByValue,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{clipValueMin:s,clipValueMax:u}=a,i=n.dataIdMap.get(r.dataId).id,o=n.makeOutput(r.shape,r.dtype),c=n.dataIdMap.get(o.dataId).id;return z(i,s,u,c),o}};function q(e){const{inputs:n,backend:a}=e,r=t.util.parseAxisParam(e.attrs.axis,n[0].shape)[0];let s=t.backend_util.computeOutShape(n.map((e=>e.shape)),r);const u=n.filter((e=>t.util.sizeFromShape(e.shape)>0));if(1===u.length)return y({inputs:{x:u[0]},backend:a});const i=a.makeOutput(s,n[0].dtype);if(0===t.util.sizeFromShape(s))return i;const o=u.map((e=>e.shape));if(t.backend_util.assertParamsConsistent(o,r),"string"===u[0].dtype){const e=u.map((e=>{const n=t.util.sizeFromShape(e.shape.slice(r));return T({inputs:{x:e},backend:a,attrs:{shape:[-1,n]}})})),o=e.map((e=>({vals:a.readSync(e.dataId),shape:e.shape})));s=t.backend_util.computeOutShape(e.map((e=>e.shape)),1);const c=1===e[0].shape[0],l=function(e,n,a,r){const s=t.util.getArrayFromDType(a,t.util.sizeFromShape(n));if(r&&"string"!==a){let n=0;e.forEach((e=>{const a=t.util.sizeFromShape(e.shape);s.set(e.vals,n),n+=a}))}else{let r=0;e.forEach((e=>{const u="string"===a?t.backend_util.fromUint8ToStringArray(e.vals):e.vals;let i=0;for(let t=0;t<e.shape[0];++t){const a=t*n[1]+r;for(let t=0;t<e.shape[1];++t)s[a+t]=u[i++]}r+=e.shape[1]}))}return s}(o,s,n[0].dtype,c),d=t.backend_util.computeOutShape(u.map((e=>e.shape)),r);i.shape=d;return a.dataIdMap.get(i.dataId).stringBytes=t.backend_util.fromStringArrayToUint8(l),e.forEach((e=>a.disposeData(e.dataId))),i}const c=t.util.sizeFromShape(u[0].shape.slice(0,r));let l=0;const d=u.map((e=>{const n=t.util.sizeFromShape(e.shape.slice(r));return l+=n,n})),p=u.map((e=>a.typedArrayFromHeap(e))),f=a.typedArrayFromHeap(i);for(let e=0;e<c;e++){let t=e*l;for(let n=0;n<p.length;n++){const a=d[n],r=e*a,s=p[n].subarray(r,r+a);f.set(s,t),t+=a}}return i}const V={kernelName:t.Concat,backendName:"wasm",kernelFunc:q};let G;const $={kernelName:t.Conv2D,backendName:"wasm",setupFunc:function(e){G=e.wasm.cwrap(t.Conv2D,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u}=n,i=r.dataIdMap.get(s.dataId).id,o=r.dataIdMap.get(u.dataId).id,{strides:c,dilations:l,pad:d,dimRoundingMode:p,dataFormat:f}=a,m=t.backend_util.convertConv2DDataFormat(f),h=t.backend_util.computeConv2DInfo(s.shape,u.shape,c,l,d,p,!1,m),b=h.filterHeight,y=h.filterWidth,_=h.padInfo.top,g=h.padInfo.right,w=h.padInfo.bottom,k=h.padInfo.left,I=h.dilationHeight,v=h.dilationWidth,S=h.strideHeight,A=h.strideWidth,M=h.inChannels,E=h.outChannels,x="SAME"===h.padInfo.type?1:0;if("channelsLast"!==h.dataFormat)throw new Error(`wasm backend Conv2D does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);const N=r.makeOutput(h.outShape,"float32"),F=r.dataIdMap.get(N.dataId).id;return G(i,s.shape[0],s.shape[1],s.shape[2],o,b,y,_,g,w,k,x,I,v,S,A,M,E,F),N}};let K;const X={kernelName:t.Conv2DBackpropInput,backendName:"wasm",setupFunc:function(e){K=e.wasm.cwrap(t.Conv2DBackpropInput,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{dy:s,filter:u}=a,{strides:i,pad:o,dataFormat:c,dimRoundingMode:l,inputShape:d}=r,p=t.backend_util.convertConv2DDataFormat(c),f=t.backend_util.computeConv2DInfo(d,u.shape,i,1,o,l,!1,p),{batchSize:m,filterHeight:h,filterWidth:b,inChannels:y,inHeight:_,inWidth:g,outChannels:w,outHeight:k,outWidth:I,strideHeight:v,strideWidth:S}=f,A=h-1-f.padInfo.top,M=b-1-f.padInfo.left,E="channelsLast"===f.dataFormat,x=t.util.computeStrides(f.inShape),N=t.util.computeStrides(s.shape),[F,T,O]=t.util.computeStrides(u.shape),C=x[0],D=E?x[1]:x[2],R=E?x[2]:1,P=E?1:x[1],W=N[0],L=E?N[1]:N[2],H=E?N[2]:1,B=E?1:N[1],U=n.makeOutput(f.inShape,"float32"),z=n.dataIdMap.get(U.dataId).id,j=n.dataIdMap.get(s.dataId).id,q=n.dataIdMap.get(u.dataId).id;return K(j,q,m,h,b,_,g,y,k,I,w,v,S,A,M,F,T,O,C,D,R,P,W,L,H,B,z),U}},Q=d(t.Cos),Y=d(t.Cosh);var Z;let J;!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(Z||(Z={}));const ee={kernelName:t.CropAndResize,backendName:"wasm",setupFunc:function(e){J=e.wasm.cwrap(t.CropAndResize,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{method:r,extrapolationValue:s,cropSize:u}=a,{image:i,boxes:o,boxInd:c}=n,l=o.shape[0],[d,p]=u,f=[l,d,p,i.shape[3]];let m,h=t.dataIdMap.get(i.dataId);"float32"!==i.dtype&&(m=H({backend:t,inputs:{x:i},attrs:{dtype:"float32"}}),h=t.dataIdMap.get(m.dataId));const b=h.id,y=t.dataIdMap.get(o.dataId).id,_=t.dataIdMap.get(c.dataId).id,g=t.makeOutput(f,"float32"),w=t.dataIdMap.get(g.dataId).id,k=new Uint8Array(new Int32Array(i.shape).buffer);return J(b,y,_,l,k,d,p,Z[r],s,w),null!=m&&t.disposeData(m.dataId),g}};let te;const ne={kernelName:t.Cumsum,backendName:"wasm",setupFunc:function(e){te=e.wasm.cwrap(t.Cumsum,null,["number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{axis:u,exclusive:o,reverse:c}=r,l=s.shape.length;t.util.assert("float32"===s.dtype||"int32"===s.dtype,(()=>`cumsum does not support ${s.dtype} tensors in the WASM backend`));const d=t.backend_util.getAxesPermutation([u],l);let p=s;null!==d&&(p=w({inputs:{x:s},attrs:{perm:d},backend:a}));const f=t.backend_util.getInnerMostAxes(1,l)[0];t.backend_util.assertAxesAreInnerMostDims("cumsum",[f],l);const m=a.makeOutput(p.shape,p.dtype),h=p.shape[f],b=a.dataIdMap.get(p.dataId).id,y=a.dataIdMap.get(m.dataId).id;te(b,o?1:0,c?1:0,h,y,i[s.dtype]);let _=m;if(null!==d){_=w({inputs:{x:m},attrs:{perm:t.backend_util.getUndoAxesPermutation(d)},backend:a}),a.disposeData(p.dataId),a.disposeData(m.dataId)}return _}};let ae;const re={kernelName:t.DepthToSpace,backendName:"wasm",setupFunc:function(e){ae=e.wasm.cwrap(t.DepthToSpace,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{x:s}=a,{blockSize:u,dataFormat:i}=r,o=s.shape[0],c=("NHWC"===i?s.shape[1]:s.shape[2])*u,l=("NHWC"===i?s.shape[2]:s.shape[3])*u,d=("NHWC"===i?s.shape[3]:s.shape[1])/(u*u),p="NHWC"===i?[o,c,l,d]:[o,d,c,l],f=n.makeOutput(p,"float32"),m=n.dataIdMap.get(s.dataId).id,h=new Uint8Array(new Int32Array(t.util.computeStrides(s.shape)).buffer),b=new Uint8Array(new Int32Array(p).buffer),y=new Uint8Array(new Int32Array(t.util.computeStrides(p)).buffer),_=n.dataIdMap.get(f.dataId).id;return ae(m,u,"NHWC"===i?1:0,h,s.shape.length-1,b,y,p.length,_),f}};let se;const ue={kernelName:t.DepthwiseConv2dNative,backendName:"wasm",setupFunc:function(e){se=e.wasm.cwrap(t.DepthwiseConv2dNative,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u}=n,i=r.dataIdMap.get(s.dataId).id,o=r.dataIdMap.get(u.dataId).id,{strides:c,dilations:l,pad:d,dimRoundingMode:p}=a,f=null==l?[1,1]:l,m=t.backend_util.computeConv2DInfo(s.shape,u.shape,c,f,d,p,!0),h=m.filterHeight,b=m.filterWidth,y=m.padInfo.top,_=m.padInfo.right,g=m.padInfo.bottom,w=m.padInfo.left,k=m.dilationHeight,I=m.dilationWidth,v=m.strideHeight,S=m.strideWidth,A=m.inChannels,M=m.outChannels,E="SAME"===m.padInfo.type?1:0;if("channelsLast"!==m.dataFormat)throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${m.dataFormat}'. Please use 'channelsLast'.`);const x=r.makeOutput(m.outShape,"float32"),N=r.dataIdMap.get(x.dataId).id;return se(i,s.shape[0],s.shape[1],s.shape[2],o,h,b,y,_,g,w,E,k,I,v,S,A,M,N),x}},ie=d(t.Elu),oe=f(t.Equal,!1,"bool"),ce=d(t.Exp,"float32");function le(e){const{inputs:n,attrs:a,backend:r}=e,{input:s}=n,{dim:u}=a,i=s.shape.length,o=s.shape.slice();let c=u;return u<0&&(t.util.assert(-(i+1)<=u,(()=>`Axis must be in the interval [${-(i+1)}, ${i}]`)),c=i+u+1),o.splice(c,0,1),T({inputs:{x:s},backend:r,attrs:{shape:o}})}const de={kernelName:t.ExpandDims,backendName:"wasm",kernelFunc:le};function pe(e){const{attrs:{shape:t,value:n,dtype:a},backend:r}=e,s=r.makeOutput(t,a);return r.typedArrayFromHeap(s).fill(n),s}const fe={kernelName:t.Fill,backendName:"wasm",kernelFunc:pe};let me;const he={kernelName:t.FlipLeftRight,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n}=e,{image:a}=t,r=n.makeOutput(a.shape,a.dtype),s=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(r.dataId).id,[i,o,c,l]=a.shape;return me(s,i,o,c,l,u),r},setupFunc:function(e){me=e.wasm.cwrap(t.FlipLeftRight,null,["number","number","number","number","number","number"])}},be=d(t.Floor),ye=f(t.FloorDiv,!1);let _e;const ge={kernelName:t.FusedBatchNorm,backendName:"wasm",setupFunc:function(e){_e=e.wasm.cwrap(t.FusedBatchNorm,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{varianceEpsilon:s}=r,{x:u,mean:i,variance:o,offset:c,scale:l}=a,d=n.dataIdMap.get(u.dataId).id,p=n.dataIdMap.get(i.dataId).id,f=n.dataIdMap.get(o.dataId).id,m=null!=c?n.dataIdMap.get(c.dataId).id:0,h=null!=l?n.dataIdMap.get(l.dataId).id:0,b=n.makeOutput(u.shape,u.dtype);if(0===t.util.sizeFromShape(u.shape))return b;const y=n.dataIdMap.get(b.dataId).id;return _e(d,p,f,m,h,s,y),b}};let we;const ke={kernelName:t.FusedConv2D,backendName:"wasm",setupFunc:function(e){we=e.wasm.cwrap(t.FusedConv2D,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u,bias:i,preluActivationWeights:c}=n,{strides:l,pad:d,dilations:p,dataFormat:f,dimRoundingMode:m,activation:h,leakyreluAlpha:b}=a,y=t.backend_util.computeConv2DInfo(s.shape,u.shape,l,p,d,m),_=o[h];if(null==_)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);const g=r.dataIdMap.get(s.dataId).id,w=r.dataIdMap.get(u.dataId).id,k=y.outChannels;let I=0;if(null!=i){const e=r.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==k)throw new Error(`FusedConv2D bias shape (${e.shape}) does not match the number of output channels (${k})`);I=e.id}const v=y.filterHeight,S=y.filterWidth,A=y.padInfo.top,M=y.padInfo.right,E=y.padInfo.bottom,x=y.padInfo.left,N=y.dilationHeight,F=y.dilationWidth,T=y.strideHeight,O=y.strideWidth,C=y.inChannels,D="SAME"===y.padInfo.type?1:0,R=y.batchSize,P=y.inHeight,W=y.inWidth;if("NHWC"!==f)throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${f}'. Please use 'NHWC'.`);const L=r.makeOutput(y.outShape,"float32"),H=r.dataIdMap.get(L.dataId).id,B=null==c?0:r.dataIdMap.get(c.dataId).id;return we(g,R,P,W,w,v,S,I,A,M,E,x,D,N,F,T,O,C,k,_,B,b||0,H),L}};let Ie;const ve={kernelName:t.FusedDepthwiseConv2D,backendName:"wasm",setupFunc:function(e){Ie=e.wasm.cwrap(t.FusedDepthwiseConv2D,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u,bias:i,preluActivationWeights:c}=n,{strides:l,pad:d,dilations:p,dataFormat:f,dimRoundingMode:m,activation:h,leakyreluAlpha:b}=a,y=t.backend_util.computeConv2DInfo(s.shape,u.shape,l,p,d,m,!0),_=o[h];if(null==_)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);const g=r.dataIdMap.get(s.dataId).id,w=r.dataIdMap.get(u.dataId).id,k=y.outChannels;let I=0;if(null!=i){const e=r.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==k)throw new Error(`FusedDepthwiseConv2D bias shape (${e.shape}) does not match the number of output channels (${k})`);I=e.id}const v=y.filterHeight,S=y.filterWidth,A=y.padInfo.top,M=y.padInfo.right,E=y.padInfo.bottom,x=y.padInfo.left,N=y.dilationHeight,F=y.dilationWidth,T=y.strideHeight,O=y.strideWidth,C=y.inChannels,D="SAME"===y.padInfo.type?1:0,R=y.batchSize,P=y.inHeight,W=y.inWidth;if("NHWC"!==f)throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${f}'. Please use 'NHWC'.`);const L=r.makeOutput(y.outShape,"float32"),H=r.dataIdMap.get(L.dataId).id,B=null==c?0:r.dataIdMap.get(c.dataId).id;return Ie(g,R,P,W,w,v,S,I,A,M,E,x,D,N,F,T,O,C,k,_,B,b||0,H),L}};let Se;const Ae={kernelName:t.GatherNd,backendName:"wasm",setupFunc:function(e){Se=e.wasm.cwrap(t.GatherNd,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){const{backend:n,inputs:a}=e,{params:r,indices:s}=a,[u,o,c,l]=t.gather_util.prepareAndValidate(r,s),d=n.makeOutput(u,r.dtype);if(0===o)return d;const p=s.shape,f=p[p.length-1],m=n.dataIdMap.get(r.dataId).id,h=n.dataIdMap.get(s.dataId).id,b=new Uint8Array(new Int32Array(l).buffer),y=n.dataIdMap.get(d.dataId).id;return Se(m,i[r.dtype],h,o,f,c,b,y),d}};let Me;const Ee={kernelName:t.GatherV2,backendName:"wasm",setupFunc:function(e){Me=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{x:s,indices:u}=a,{axis:o,batchDims:c}=r,l=t.util.parseAxisParam(o,s.shape)[0],d=n.readSync(u.dataId),p=s.shape[l];for(let e=0;e<d.length;++e){const n=d[e];t.util.assert(n<=p-1&&n>=0,(()=>`GatherV2: the index value ${n} is not in [0, ${p-1}]`))}const f=t.backend_util.segment_util.collectGatherOpShapeInfo(s,u,l,c),m=T({inputs:{x:s},attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]},backend:n}),h=t.util.sizeFromShape(u.shape),b=T({inputs:{x:u},attrs:{shape:[f.batchSize,h/f.batchSize]},backend:n}),y=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],_=n.makeOutput(y,s.dtype);if(0===t.util.sizeFromShape(s.shape))return _;const g=m.shape.length-1,w=n.dataIdMap.get(m.dataId).id,k=n.dataIdMap.get(b.dataId).id,I=n.dataIdMap.get(_.dataId).id,v=new Uint8Array(new Int32Array(t.util.computeStrides(m.shape)).buffer),S=new Uint8Array(new Int32Array(t.util.computeStrides(y)).buffer);return Me(w,i[s.dtype],v,g,k,f.batchSize,S,I),n.disposeData(m.dataId),n.disposeData(b.dataId),_.shape=f.outputShape,_}},xe=f(t.Greater,!1,"bool"),Ne=f(t.GreaterEqual,!1,"bool");let Fe;const Te={kernelName:t.LeakyRelu,backendName:"wasm",setupFunc:function(e){Fe=e.wasm.cwrap(t.LeakyRelu,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:{x:n},attrs:{alpha:a},backend:r}=e,s=r.dataIdMap.get(n.dataId).id,u=r.makeOutput(n.shape,"float32");if(0!==t.util.sizeFromShape(n.shape)){const e=r.dataIdMap.get(u.dataId).id;Fe(s,i[n.dtype],a,e)}return u}},Oe=f(t.Less,!1,"bool"),Ce=f(t.LessEqual,!1,"bool"),De=d(t.Log),Re=f(t.LogicalAnd,!1,"bool");let Pe;const We={kernelName:t.Max,backendName:"wasm",setupFunc:function(e){Pe=e.wasm.cwrap(t.Max,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{reductionIndices:s,keepDims:u}=r,{x:o}=a;let c=n.dataIdMap.get(o.dataId).id,l=o;const{transposed:d,axes:p,originalAxes:f,inputWasTransposed:m}=I(o,s,n);if(m){l=d,c=n.dataIdMap.get(d.dataId).id}const h=l.shape.length;t.backend_util.assertAxesAreInnerMostDims("max",p,h);const[b,y]=t.backend_util.computeOutAndReduceShapes(l.shape,p),_=t.util.sizeFromShape(y),g=n.makeOutput(b,o.dtype);if(0!==t.util.sizeFromShape(l.shape)){const e=n.dataIdMap.get(g.dataId).id;Pe(c,i[o.dtype],_,e)}if(m&&n.disposeData(d.dataId),u){const e=t.backend_util.expandShapeToKeepDim(g.shape,f);g.shape=e}return g}},Le=f(t.Maximum,!1);let He;const Be={kernelName:t.MaxPool,backendName:"wasm",setupFunc:function(e){He=e.wasm.cwrap(t.MaxPool,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,s=n.x,u=r.dataIdMap.get(s.dataId).id;t.util.assert("float32"===s.dtype,(()=>`Error in MaxPool: only float32 input is supported. Got ${s.dtype}.`));const{filterSize:i,strides:o,pad:c,dimRoundingMode:l}=a,d=t.backend_util.computePool2DInfo(s.shape,i,o,1,c,l),p=d.filterHeight,f=d.filterWidth,m=d.padInfo.top,h=d.padInfo.right,b=d.padInfo.bottom,y=d.padInfo.left,_=d.dilationHeight,g=d.dilationWidth,w=d.strideHeight,k=d.strideWidth,I=d.inChannels,v=d.outChannels;if("channelsLast"!==d.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${d.dataFormat}'. Please use 'channelsLast'.`);const S=r.makeOutput(d.outShape,"float32"),A=r.dataIdMap.get(S.dataId).id;return He(u,s.shape[0],s.shape[1],s.shape[2],p,f,m,h,b,y,_,g,w,k,I,v,A),S}};let Ue;const ze={kernelName:t.Mean,backendName:"wasm",setupFunc:function(e){Ue=e.wasm.cwrap(t.Mean,null,["number, number, number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a,o=n.dataIdMap.get(i.dataId).id;let c=o,l=i;const{transposed:d,axes:p,originalAxes:f,inputWasTransposed:m}=I(i,s,n);let h=p;if(m){const e=n.dataIdMap.get(d.dataId).id;e!==o&&(l=d,c=e,h=t.backend_util.getInnerMostAxes(h.length,l.shape.length))}t.backend_util.assertAxesAreInnerMostDims("mean",h,l.shape.length);const[b,y]=t.backend_util.computeOutAndReduceShapes(l.shape,h),_=t.util.sizeFromShape(y);let g=l;"float32"!==l.dtype&&(g=H({backend:n,inputs:{x:l},attrs:{dtype:"float32"}}),c=n.dataIdMap.get(g.dataId).id);const w=n.makeOutput(b,"float32");if(0!==t.util.sizeFromShape(l.shape)){const e=n.dataIdMap.get(w.dataId).id;Ue(c,_,e)}if(m&&n.disposeData(d.dataId),u){const e=t.backend_util.expandShapeToKeepDim(w.shape,f);w.shape=e}return"float32"!==l.dtype&&n.disposeData(g.dataId),w}};let je;const qe={kernelName:t.Min,backendName:"wasm",setupFunc:function(e){je=e.wasm.cwrap(t.Min,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:o}=a,c=n.dataIdMap.get(o.dataId).id;let l=c,d=o;const{transposed:p,axes:f,originalAxes:m,inputWasTransposed:h}=I(o,s,n);if(h){const e=n.dataIdMap.get(p.dataId).id;e!==c&&(d=p,l=e)}const b=d.shape.length;t.backend_util.assertAxesAreInnerMostDims("min",f,b);const[y,_]=t.backend_util.computeOutAndReduceShapes(d.shape,f),g=t.util.sizeFromShape(_),w=n.makeOutput(y,d.dtype);if(0!==t.util.sizeFromShape(d.shape)){const e=n.dataIdMap.get(w.dataId).id;je(l,i[o.dtype],g,e)}if(h&&n.disposeData(p.dataId),u){const e=t.backend_util.expandShapeToKeepDim(w.shape,m);w.shape=e}return w}},Ve=f(t.Minimum,!1);var Ge;let $e;!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}(Ge||(Ge={}));const Ke={kernelName:t.MirrorPad,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n,attrs:{paddings:a,mode:r}}=e,s=a.map(((e,n)=>e[0]+t.shape[n]+e[1])),u=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(s,t.dtype),c=n.dataIdMap.get(o.dataId).id,l=new Uint8Array(new Int32Array(t.shape).buffer),d=a.map((e=>e[0])),p=a.map((e=>e[1])),f=new Uint8Array(new Int32Array(d).buffer),m=new Uint8Array(new Int32Array(p).buffer);return $e(u,l,t.shape.length,i[t.dtype],f,m,Ge[r],c),o},setupFunc:function(e){$e=e.wasm.cwrap(t.MirrorPad,null,["number","array","number","number","array","array","number","number"])}},Xe=f(t.Multiply,!0),Qe=d(t.Neg);function Ye(e,t){const n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),a=n[0],r=n[1],s=n[2],u=n[3];return e.wasm._free(t),{pSelectedIndices:a,selectedSize:r,pSelectedScores:s,pValidOutputs:u}}let Ze;const Je={kernelName:t.NonMaxSuppressionV3,backendName:"wasm",setupFunc:function(e){Ze=e.wasm.cwrap(t.NonMaxSuppressionV3,"number",["number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u}=a,{boxes:i,scores:o}=n,c=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(o.dataId).id,d=Ze(c,l,s,r,u),{pSelectedIndices:p,selectedSize:f,pSelectedScores:m,pValidOutputs:h}=Ye(t,d);return t.wasm._free(m),t.wasm._free(h),t.makeOutput([f],"int32",p)}};let et;const tt={kernelName:t.NonMaxSuppressionV4,backendName:"wasm",setupFunc:function(e){et=e.wasm.cwrap(t.NonMaxSuppressionV4,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u,padToMaxOutputSize:i}=a,{boxes:o,scores:c}=n,l=t.dataIdMap.get(o.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=et(l,d,s,r,u,i),{pSelectedIndices:f,selectedSize:m,pSelectedScores:h,pValidOutputs:b}=Ye(t,p);return t.wasm._free(h),[t.makeOutput([m],"int32",f),t.makeOutput([],"int32",b)]}};let nt;const at={kernelName:t.NonMaxSuppressionV5,backendName:"wasm",setupFunc:function(e){nt=e.wasm.cwrap(t.NonMaxSuppressionV5,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u,softNmsSigma:i}=a,{boxes:o,scores:c}=n,l=t.dataIdMap.get(o.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=nt(l,d,s,r,u,i),{pSelectedIndices:f,selectedSize:m,pSelectedScores:h,pValidOutputs:b}=Ye(t,p);return t.wasm._free(b),[t.makeOutput([m],"int32",f),t.makeOutput([m],"float32",h)]}},rt=f(t.NotEqual,!1,"bool");let st;const ut={kernelName:t.OneHot,backendName:"wasm",setupFunc:function(e){st=e.wasm.cwrap(t.OneHot,null,["number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{depth:s,onValue:u,offValue:i}=a,o=n.makeOutput([...r.shape,s],"int32"),c=n.dataIdMap.get(o.dataId).id,l=n.dataIdMap.get(r.dataId).id;return st(l,s,u,i,c),o}};const it={kernelName:t.OnesLike,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(1),a}};const ot={kernelName:t.Pack,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{axis:s}=r;if(1===n.length)return le({inputs:{input:n[0]},backend:a,attrs:{dim:s}});const u=n[0].shape,i=n[0].dtype;n.forEach((e=>{t.util.assertShapesMatch(u,e.shape,"All tensors passed to stack must have matching shapes"),t.util.assert(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const o=[],c=q({inputs:n.map((e=>{const t=le({inputs:{input:e},backend:a,attrs:{dim:s}});return o.push(t),t})),backend:a,attrs:{axis:s}});return o.forEach((e=>a.disposeData(e.dataId))),c}};let ct;const lt={kernelName:t.PadV2,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:n},backend:a,attrs:{paddings:r,constantValue:s}}=e,u=r.map(((e,t)=>e[0]+n.shape[t]+e[1]));if(0===t.util.sizeFromShape(n.shape))return pe({backend:a,attrs:{shape:u,value:s,dtype:n.dtype}});const o=a.dataIdMap.get(n.dataId).id,c=a.makeOutput(u,n.dtype),l=a.dataIdMap.get(c.dataId).id,d=new Uint8Array(new Int32Array(n.shape).buffer),p=r.map((e=>e[0])),f=r.map((e=>e[1])),m=new Uint8Array(new Int32Array(p).buffer),h=new Uint8Array(new Int32Array(f).buffer);return ct(o,d,n.shape.length,i[n.dtype],m,h,s,l),c},setupFunc:function(e){ct=e.wasm.cwrap(t.PadV2,null,["number","array","number","number","array","array","number","number"])}},dt=f(t.Pow,!1);let pt;const ft={kernelName:t.Prelu,backendName:"wasm",setupFunc:function(e){pt=e.wasm.cwrap(t.Prelu,null,["number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a,alpha:r}=t,s=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(r.dataId).id;let i=s;const o=a;let c=o;"float32"!==o.dtype&&(c=H({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),i=n.dataIdMap.get(c.dataId).id);const l=n.makeOutput(a.shape,"float32"),d=n.dataIdMap.get(l.dataId).id;return pt(i,u,d),"float32"!==o.dtype&&n.disposeData(c.dataId),l}};let mt;const ht={kernelName:t.Prod,backendName:"wasm",setupFunc:function(e){mt=e.wasm.cwrap(t.Prod,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:o}=a,c=n.dataIdMap.get(o.dataId).id;let l=c,d=o;const{transposed:p,axes:f,originalAxes:m,inputWasTransposed:h}=I(o,s,n);let b=f;if(h){const e=n.dataIdMap.get(p.dataId).id;e!==c&&(d=p,l=e,b=t.backend_util.getInnerMostAxes(b.length,d.shape.length))}t.backend_util.assertAxesAreInnerMostDims("prod",b,d.shape.length);const[y,_]=t.backend_util.computeOutAndReduceShapes(d.shape,b),g=t.util.sizeFromShape(_),w=n.makeOutput(y,d.dtype);if(0!==t.util.sizeFromShape(d.shape)){const e=n.dataIdMap.get(w.dataId).id;mt(l,g,i[w.dtype],e)}if(h&&n.disposeData(p.dataId),u){const e=t.backend_util.expandShapeToKeepDim(w.shape,m);w.shape=e}return w}},bt={kernelName:t.Range,backendName:"wasm",kernelFunc:e=>{const{backend:n,attrs:a}=e,{start:r,stop:s,step:u,dtype:i}=a,o=function(e,n,a,r){if(e===n||e<n&&a<0||n<e&&a>1)return t.util.makeZerosTypedArray(0,r);const s=Math.abs(Math.ceil((n-e)/a)),u=t.util.makeZerosTypedArray(s,r);n<e&&1===a&&(a=-1),u[0]=e;for(let e=1;e<u.length;e++)u[e]=u[e-1]+a;return u}(r,s,u,i),c=n.makeOutput([o.length],i);return n.typedArrayFromHeap(c).set(o),c}},yt=f(t.RealDiv,!0),_t=d(t.Relu),gt=d(t.Relu6);let wt;const kt={kernelName:t.ResizeBilinear,backendName:"wasm",setupFunc:function(e){wt=e.wasm.cwrap(t.ResizeBilinear,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{images:s}=a,{alignCorners:u,halfPixelCenters:i,size:o}=r,[c,l]=o,[d,p,f,m]=s.shape,h=[d,c,l,m];let b,y=n.dataIdMap.get(s.dataId);"float32"!==y.dtype&&(b=H({backend:n,inputs:{x:s},attrs:{dtype:"float32"}}),y=n.dataIdMap.get(b.dataId));const _=y.id,g=n.makeOutput(h,"float32");if(0===t.util.sizeFromShape(s.shape))return g;const w=n.dataIdMap.get(g.dataId).id;return wt(_,d,p,f,m,c,l,u?1:0,i?1:0,w),null!=b&&n.disposeData(b.dataId),g}};let It;const vt={kernelName:t.Reverse,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{dims:u}=r,i=t.util.parseAxisParam(u,s.shape);if(0===s.shape.length)return y({inputs:{x:s},backend:a});const o=a.makeOutput(s.shape,s.dtype),c=a.dataIdMap.get(s.dataId).id,l=a.dataIdMap.get(o.dataId).id,d=new Uint8Array(new Int32Array(i).buffer),p=new Uint8Array(new Int32Array(s.shape).buffer);It(c,d,i.length,p,s.shape.length,l);const f=T({inputs:{x:o},attrs:{shape:s.shape},backend:a});return a.disposeData(o.dataId),f},setupFunc:function(e){It=e.wasm.cwrap(t.Reverse,null,["number","array","number","array","number","number"])}};let St;const At={kernelName:t.RotateWithOffset,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{image:s}=n,{radians:u,fillValue:i,center:o}=r,c=a.makeOutput(s.shape,s.dtype),l=a.dataIdMap.get(s.dataId).id,d=a.dataIdMap.get(c.dataId).id,[p,f,m,h]=s.shape,[b,y]=t.backend_util.getImageCenter(o,f,m),_="number"==typeof i?[i,i,i,0===i?0:255]:[...i,255],g=new Uint8Array(new Int32Array(_).buffer);return St(l,p,f,m,h,u,b,y,g,_.length,d),c},setupFunc:function(e){St=e.wasm.cwrap(t.RotateWithOffset,null,["number","number","number","number","number","number","number","number","array","number","number"])}},Mt=d(t.Round),Et=d(t.Rsqrt);let xt;const Nt={kernelName:t.ScatterNd,backendName:"wasm",setupFunc:function(e){xt=e.wasm.cwrap(t.ScatterNd,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{indices:s,updates:u}=a,{shape:o}=r,c=n.makeOutput(o,u.dtype);if(0===t.util.sizeFromShape(o))return c;const{sliceRank:l,numUpdates:d,sliceSize:p,strides:f,outputSize:m}=t.scatter_util.calculateShapes(u,s,o),h=n.dataIdMap.get(s.dataId).id,b=n.dataIdMap.get(u.dataId).id,y=new Uint8Array(new Int32Array(f).buffer),_=n.dataIdMap.get(c.dataId).id;return xt(h,b,i[u.dtype],l,d,p,y,m,_),c}};let Ft;const Tt={kernelName:t.Select,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a}=e,{condition:r,t:s,e:u}=n,i=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(s.dataId).id,c=a.dataIdMap.get(u.dataId).id,l=a.makeOutput(s.shape,s.dtype),d=a.dataIdMap.get(l.dataId).id,p=r.shape.length,f=s.shape.length,m=0===p||p>1||1===f?1:t.util.sizeFromShape(s.shape.slice(1));return Ft(i,o,c,m,d),l},setupFunc:function(e){Ft=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}};let Ot;const Ct={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){Ot=e.wasm.cwrap(t.Sigmoid,null,["number","number"])},kernelFunc:function(e){const{backend:n,inputs:{x:a}}=e,r=n.dataIdMap.get(a.dataId).id,s=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(s.dataId).id;return 0===t.util.sizeFromShape(s.shape)||Ot(r,u),s}},Dt=d(t.Sin);let Rt;const Pt={kernelName:t.Softmax,backendName:"wasm",setupFunc:function(e){Rt=e.wasm.cwrap(t.Softmax,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:{logits:a},attrs:{dim:r}}=e,s=n.dataIdMap.get(a.dataId).id,u=n.makeOutput(a.shape,a.dtype),i=n.dataIdMap.get(u.dataId).id,o=a.shape[r],c=t.util.sizeFromShape(a.shape)/o;return 0===t.util.sizeFromShape(u.shape)||Rt(s,i,o,c),u}};const Wt={kernelName:t.SpaceToBatchND,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{blockShape:u,paddings:i}=r,o=t.util.sizeFromShape(u),c=[[0,0]];c.push(...i);for(let e=1+u.length;e<s.shape.length;++e)c.push([0,0]);const l=lt.kernelFunc({inputs:{x:s},backend:a,attrs:{paddings:c,constantValue:0}}),d=t.backend_util.getReshaped(l.shape,u,o,!1),p=t.backend_util.getPermuted(d.length,u.length,!1),f=t.backend_util.getReshapedPermuted(l.shape,u,o,!1),m=T({inputs:{x:l},backend:a,attrs:{shape:d}}),h=w({inputs:{x:m},backend:a,attrs:{perm:p}}),b=T({inputs:{x:h},backend:a,attrs:{shape:f}});return a.disposeData(l.dataId),a.disposeData(m.dataId),a.disposeData(h.dataId),b}};const Lt={kernelName:t.SplitV,backendName:"wasm",kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s}=n,{numOrSizeSplits:u,axis:i}=a,o=t.util.parseAxisParam(i,s.shape)[0],c=t.backend_util.prepareSplitSize(s,u,o),l=new Array(s.shape.length).fill(0),d=s.shape.slice();return c.map((e=>{const t=[...d];t[o]=e;const n=P({inputs:{x:s},attrs:{begin:l,size:t},backend:r});return l[o]+=e,n}))}},Ht=d(t.Sqrt),Bt=d(t.Square),Ut=f(t.SquaredDifference,!0);let zt;const jt={kernelName:t.Step,backendName:"wasm",setupFunc:function(e){zt=e.wasm.cwrap(t.Step,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{alpha:r}=a,{x:s}=n,u=t.dataIdMap.get(s.dataId).id,o=t.makeOutput(s.shape,s.dtype),c=t.dataIdMap.get(o.dataId).id;return zt(u,r,i[s.dtype],c),o}};let qt;const Vt={kernelName:t.StridedSlice,backendName:"wasm",setupFunc:function(e){qt=e.wasm.cwrap(t.StridedSlice,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{x:s}=a,{begin:u,end:i,strides:o,beginMask:c,endMask:l,ellipsisMask:d,newAxisMask:p,shrinkAxisMask:f}=r,{finalShapeSparse:m,finalShape:h,isIdentity:b,sliceDim0:y,isSimpleSlice:_,begin:g,end:w,strides:k}=t.slice_util.sliceInfo(s.shape,u,i,o,c,l,d,p,f);let I;if(b)I=T({inputs:{x:s},backend:n,attrs:{shape:h}});else if(y||_){t.util.assert(s.shape.length>=1,(()=>`Input must have rank at least 1, got: ${s.shape.length}`));const e=t.slice_util.computeOutShape(g,w,k),a=P({inputs:{x:s},backend:n,attrs:{begin:g,size:e}});I=T({inputs:{x:a},backend:n,attrs:{shape:h}}),n.disposeData(a.dataId)}else{const e=n.makeOutput(m,"float32"),a=n.dataIdMap.get(s.dataId).id,r=new Uint8Array(new Int32Array(t.util.computeStrides(s.shape)).buffer),u=new Uint8Array(new Int32Array(g).buffer),i=new Uint8Array(new Int32Array(w).buffer),o=new Uint8Array(new Int32Array(k).buffer),c=new Uint8Array(new Int32Array(m).buffer),l=new Uint8Array(new Int32Array(t.util.computeStrides(m)).buffer),d=n.dataIdMap.get(e.dataId).id;qt(a,r,s.shape.length,u,i,o,c,l,m.length,d),I=T({inputs:{x:e},backend:n,attrs:{shape:h}}),n.disposeData(e.dataId)}return I}},Gt=f(t.Sub,!0);let $t;const Kt={kernelName:t.Sum,backendName:"wasm",setupFunc:function(e){$t=e.wasm.cwrap(t.Sum,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:o}=a,c=n.dataIdMap.get(o.dataId).id;let l=c,d=o;const{transposed:p,axes:f,originalAxes:m,inputWasTransposed:h}=I(o,s,n);let b=f;if(h){const e=n.dataIdMap.get(p.dataId).id;e!==c&&(d=p,l=e,b=t.backend_util.getInnerMostAxes(b.length,d.shape.length))}t.backend_util.assertAxesAreInnerMostDims("sum",b,d.shape.length);const[y,_]=t.backend_util.computeOutAndReduceShapes(d.shape,b),g=t.util.sizeFromShape(_),w=n.makeOutput(y,d.dtype);if(0!==t.util.sizeFromShape(d.shape)){const e=n.dataIdMap.get(w.dataId).id;$t(l,g,i[w.dtype],e)}if(h&&n.disposeData(p.dataId),u){const e=t.backend_util.expandShapeToKeepDim(w.shape,m);w.shape=e}return w}},Xt=d(t.Tan),Qt=d(t.Tanh);let Yt;const Zt={kernelName:t.Tile,backendName:"wasm",setupFunc:function(e){Yt=e.wasm.cwrap(t.Tile,null,["number","array","number","array","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:r}=t,s=n.dataIdMap.get(r.dataId).id,{reps:u}=a,o=new Array(r.shape.length);for(let e=0;e<o.length;e++)o[e]=r.shape[e]*u[e];const c=new Uint8Array(new Int32Array(r.shape).buffer),l=new Uint8Array(new Int32Array(o).buffer),d=n.makeOutput(o,r.dtype),p=n.dataIdMap.get(d.dataId).id;return Yt(s,c,r.shape.length,l,o.length,i[d.dtype],p),d}};let Jt;const en={kernelName:t.TopK,backendName:"wasm",setupFunc:function(e){Jt=e.wasm.cwrap(t.TopK,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:a}=e,{k:r,sorted:s}=n,u=t.dataIdMap.get(a.dataId).id,o=new Uint8Array(new Int32Array(a.shape).buffer),c=a.shape.slice();c[c.length-1]=r;const l=t.makeOutput(c,a.dtype),d=t.dataIdMap.get(l.dataId).id,p=t.makeOutput(c,"int32"),f=t.dataIdMap.get(p.dataId).id;return Jt(u,o,a.shape.length,i[a.dtype],r,s,d,f),[l,p]}};let tn;const nn={kernelName:t.Transform,backendName:"wasm",setupFunc:function(e){tn=e.wasm.cwrap(t.Transform,null,["number","number","bool","number","number","number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{image:s,transforms:u}=a,{interpolation:i,fillMode:o,fillValue:c,outputShape:l}=r,[d,p,f,m]=s.shape,[h,b]=null!=l?l:[p,f],y=[d,h,b,m],_=new Uint8Array(new Int32Array(t.util.computeStrides(s.shape)).buffer),g=n.makeOutput(y,s.dtype),w=n.dataIdMap.get(g.dataId).id,k=n.dataIdMap.get(s.dataId).id,I=n.dataIdMap.get(u.dataId).id,v="nearest"===i?1:2;let S;switch(o){case"constant":S=1;break;case"reflect":S=2;break;case"wrap":S=3;break;case"nearest":S=4;break;default:S=1}return tn(k,I,u.shape[0]>1,d,h,b,m,f,p,_,s.shape.length-1,v,S,c,w),g}};const an={kernelName:t.Unpack,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{value:r}=t;let{axis:s}=a;s<0&&(s+=r.shape.length);const u=r.shape[s],i=r.shape.length,o=new Array(i-1);let c=0;for(let e=0;e<i;e++)e!==s&&(o[c++]=r.shape[e]);const l=new Array(u),d=new Array(i).fill(0),p=r.shape.slice();p[s]=1;for(let e=0;e<l.length;e++)d[s]=e,l[e]=P({inputs:{x:r},attrs:{begin:d,size:p},backend:n});return l.map((({dataId:e,dtype:t})=>({dataId:e,dtype:t,shape:o})))}};const rn={kernelName:t.ZerosLike,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(0),a}},sn=[p,m,b,S,M,x,F,D,L,B,U,j,V,$,X,Q,Y,ee,ne,re,ue,ie,oe,ce,de,fe,he,be,ye,l,ge,ke,ve,Ae,Ee,xe,Ne,_,Te,Oe,Ce,De,Re,We,Le,Be,ze,qe,Ve,Ke,Xe,Qe,Je,tt,at,rt,ut,it,ot,lt,dt,ft,ht,bt,yt,_t,gt,O,kt,vt,At,Et,Mt,Nt,Tt,Ct,Dt,W,Pt,Wt,Lt,Ht,Bt,Ut,jt,Vt,Gt,Kt,Xt,Qt,Zt,en,nn,k,an,rn];for(const e of sn)t.registerKernel(e);const un=t.env();un.registerFlag("WASM_HAS_SIMD_SUPPORT",(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11])))),un.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",(async()=>{if(un.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}}));var on="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function cn(e,t){return e(t={exports:{}},t.exports),t.exports}var ln=cn((function(e,t){var i,o=(i="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(i=i||__filename),function(e){function t(){return R.buffer!=L&&ne(R.buffer),H}function o(){return R.buffer!=L&&ne(R.buffer),B}function c(){return R.buffer!=L&&ne(R.buffer),U}function l(){return R.buffer!=L&&ne(R.buffer),z}function d(){return R.buffer!=L&&ne(R.buffer),j}var p,f,m="undefined"!=typeof(e=e||{})?e:{};m.ready=new Promise((function(e,t){p=e,f=t}));var h,b={};for(h in m)m.hasOwnProperty(h)&&(b[h]=m[h]);var y=function(e,t){throw t},_=!1,g=!1,w=!1,k=!1;_="object"==typeof window,g="function"==typeof importScripts,w="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,k=!_&&!w&&!g;var I=m.ENVIRONMENT_IS_PTHREAD||!1;I&&(L=m.buffer);var v,S,A,M,E,x="";function N(e){return m.locateFile?m.locateFile(e,x):x+e}if(w){var F;x=g?n.dirname(x)+"/":__dirname+"/",v=function(e,t){return M||(M=a),E||(E=n),e=E.normalize(e),M.readFileSync(e,t?null:"utf8")},A=function(e){var t=v(e,!0);return t.buffer||(t=new Uint8Array(t)),V(t.buffer),t},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof hn))throw e})),process.on("unhandledRejection",ge),y=function(e){process.exit(e)},m.inspect=function(){return"[Emscripten Module object]"};try{F=r}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}on.Worker=F.Worker}else k?("undefined"!=typeof read&&(v=function(e){return read(e)}),A=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(V("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs&&scriptArgs,"function"==typeof quit&&(y=function(e){quit(e)}),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(_||g)&&(g?x=self.location.href:"undefined"!=typeof document&&document.currentScript&&(x=document.currentScript.src),"undefined"!=typeof i&&i&&(x=i),x=0!==x.indexOf("blob:")?x.substr(0,x.lastIndexOf("/")+1):"",w?(v=function(e,t){return M||(M=a),E||(E=n),e=E.normalize(e),M.readFileSync(e,t?null:"utf8")},A=function(e){var t=v(e,!0);return t.buffer||(t=new Uint8Array(t)),V(t.buffer),t}):(v=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(A=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),S=function(e,t,n){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)}));w&&"undefined"==typeof performance&&(on.performance=s.performance);var T,O=m.print||console.log.bind(console),C=m.printErr||console.warn.bind(console);for(h in b)b.hasOwnProperty(h)&&(m[h]=b[h]);function D(e){D.shown||(D.shown={}),D.shown[e]||(D.shown[e]=1,C(e))}b=null,m.arguments&&m.arguments,m.thisProgram&&m.thisProgram,m.quit&&(y=m.quit),m.wasmBinary&&(T=m.wasmBinary);var R,P,W=m.noExitRuntime||!0;"object"!=typeof WebAssembly&&ge("no native wasm support detected");var L,H,B,U,z,j,q=!1;function V(e,t){e||ge("Assertion failed: "+t)}function G(e){var t=m["_"+e];return V(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function $(e,t,n,a,r){var s={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);Z(e,t=ln(n),n)}return t},array:function(e){var t=ln(e.length);return ee(e,t),t}},u=G(e),i=[],o=0;if(a)for(var c=0;c<a.length;c++){var l=s[n[c]];l?(0===o&&(o=un()),i[c]=l(a[c])):i[c]=a[c]}var d=u.apply(null,i);return d=function(e){return"string"===t?Q(e):"boolean"===t?Boolean(e):e}(d),0!==o&&cn(o),d}function K(e,t,n,a){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!a?G(e):function(){return $(e,t,n,arguments)}}function X(e,t,n){for(var a=t+n,r="";!(t>=a);){var s=e[t++];if(!s)return r;if(128&s){var u=63&e[t++];if(192!=(224&s)){var i=63&e[t++];if((s=224==(240&s)?(15&s)<<12|u<<6|i:(7&s)<<18|u<<12|i<<6|63&e[t++])<65536)r+=String.fromCharCode(s);else{var o=s-65536;r+=String.fromCharCode(55296|o>>10,56320|1023&o)}}else r+=String.fromCharCode((31&s)<<6|u)}else r+=String.fromCharCode(s)}return r}function Q(e,t){return e?X(o(),e,t):""}function Y(e,t,n,a){if(!(a>0))return 0;for(var r=n,s=n+a-1,u=0;u<e.length;++u){var i=e.charCodeAt(u);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++u)),i<=127){if(n>=s)break;t[n++]=i}else if(i<=2047){if(n+1>=s)break;t[n++]=192|i>>6,t[n++]=128|63&i}else if(i<=65535){if(n+2>=s)break;t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i}else{if(n+3>=s)break;t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i}}return t[n]=0,n-r}function Z(e,t,n){return Y(e,o(),t,n)}function J(e){for(var t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++n)),a<=127?++t:t+=a<=2047?2:a<=65535?3:4}return t}function ee(e,n){t().set(e,n)}function te(e,t){return e%t>0&&(e+=t-e%t),e}function ne(e){L=e,m.HEAP8=H=new Int8Array(e),m.HEAP16=new Int16Array(e),m.HEAP32=U=new Int32Array(e),m.HEAPU8=B=new Uint8Array(e),m.HEAPU16=new Uint16Array(e),m.HEAPU32=z=new Uint32Array(e),m.HEAPF32=new Float32Array(e),m.HEAPF64=j=new Float64Array(e)}var ae,re=m.INITIAL_MEMORY||16777216;if(I)R=m.wasmMemory,L=m.buffer;else if(m.wasmMemory)R=m.wasmMemory;else if(!((R=new WebAssembly.Memory({initial:re/65536,maximum:32768,shared:!0})).buffer instanceof SharedArrayBuffer))throw C("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),w&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");R&&(L=R.buffer),re=L.byteLength,ne(L);var se=[],ue=[],ie=[],oe=[];function ce(){if(!I){if(m.preRun)for("function"==typeof m.preRun&&(m.preRun=[m.preRun]);m.preRun.length;)fe(m.preRun.shift());Te(se)}}function le(){I||Te(ue)}function de(){I||Te(ie)}function pe(){if(!I){if(m.postRun)for("function"==typeof m.postRun&&(m.postRun=[m.postRun]);m.postRun.length;)me(m.postRun.shift());Te(oe)}}function fe(e){se.unshift(e)}function me(e){oe.unshift(e)}I||ue.push({func:function(){Vt()}});var he=0,be=null;function ye(e){V(!I,"addRunDependency cannot be used in a pthread worker"),he++,m.monitorRunDependencies&&m.monitorRunDependencies(he)}function _e(e){if(he--,m.monitorRunDependencies&&m.monitorRunDependencies(he),0==he&&be){var t=be;be=null,t()}}function ge(e){m.onAbort&&m.onAbort(e),I&&console.error("Pthread aborting at "+(new Error).stack),C(e+=""),q=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw f(t),t}function we(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}m.preloadedImages={},m.preloadedAudios={};var ke="data:application/octet-stream;base64,";function Ie(e){return we(e,ke)}var ve="file://";function Se(e){return we(e,ve)}var Ae="tfjs-backend-wasm-threaded-simd.wasm";function Me(e){try{if(e==Ae&&T)return new Uint8Array(T);if(A)return A(e);throw"both async and sync fetching of the wasm failed"}catch(e){ge(e)}}function Ee(){if(!T&&(_||g)){if("function"==typeof fetch&&!Se(Ae))return fetch(Ae,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Ae+"'";return e.arrayBuffer()})).catch((function(){return Me(Ae)}));if(S)return new Promise((function(e,t){S(Ae,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return Me(Ae)}))}function xe(){var e={a:qt};function t(e,t){var n=e.exports;if(m.asm=n,ae=m.asm.I,P=t,!I){var a=Le.unusedWorkers.length;Le.unusedWorkers.forEach((function(e){Le.loadWasmModuleToWorker(e,(function(){--a||_e()}))}))}}function n(e){t(e.instance,e.module)}function a(t){return Ee().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){C("failed to asynchronously prepare wasm: "+e),ge(e)}))}if(I||ye(),m.instantiateWasm)try{return m.instantiateWasm(e,t)}catch(e){return C("Module.instantiateWasm callback failed with error: "+e),!1}return(T||"function"!=typeof WebAssembly.instantiateStreaming||Ie(Ae)||Se(Ae)||"function"!=typeof fetch?a(n):fetch(Ae,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return C("wasm streaming compile failed: "+e),C("falling back to ArrayBuffer instantiation"),a(n)}))}))).catch(f),{}}Ie(Ae)||(Ae=N(Ae));var Ne={10520:function(){throw"Canceled!"},10538:function(e,t){setTimeout((function(){tn(e,t)}),0)}};function Fe(){Le.initRuntime()}function Te(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?ae.get(n)():ae.get(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(m)}}var Oe={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};function Ce(e,n){if(e<=0||e>t().length||!0&e||n<0)return-28;if(0==n)return 0;n>=2147483647&&(n=1/0);var a=Atomics.load(c(),mn>>2),r=0;if(a==e&&Atomics.compareExchange(c(),mn>>2,a,0)==a&&(r=1,--n<=0))return 1;var s=Atomics.notify(c(),e>>2,n);if(s>=0)return s+r;throw"Atomics.notify returned an unexpected value "+s}function De(e){if(I)throw"Internal Error! killThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in killThread!";c()[e+12>>2]=0;var t=Le.pthreads[e];t.worker.terminate(),Le.freeThreadData(t),Le.runningWorkers.splice(Le.runningWorkers.indexOf(t.worker),1),t.worker.pthread=void 0}function Re(e){if(I)throw"Internal Error! cancelThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cancelThread!";Le.pthreads[e].worker.postMessage({cmd:"cancel"})}function Pe(e){if(I)throw"Internal Error! cleanupThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cleanupThread!";var t=Le.pthreads[e];if(t){c()[e+12>>2]=0;var n=t.worker;Le.returnWorkerToPool(n)}}m._emscripten_futex_wake=Ce;var We,Le={unusedWorkers:[],runningWorkers:[],initMainThreadBlock:function(){for(var e=0;e<8;++e)Le.allocateUnusedWorker()},initRuntime:function(){for(var e=Gt(228),t=0;t<57;++t)l()[e/4+t]=0;c()[e+12>>2]=e;var n=e+152;c()[n>>2]=n;var a=Gt(512);for(t=0;t<128;++t)l()[a/4+t]=0;Atomics.store(l(),e+100>>2,a),Atomics.store(l(),e+40>>2,e),sn(e,!g,1),Jt(e)},initWorker:function(){},pthreads:{},threadExitHandlers:[],setThreadStatus:function(){},runExitHandlers:function(){for(;Le.threadExitHandlers.length>0;)Le.threadExitHandlers.pop()();I&&Qt()&&Yt()},runExitHandlersAndDeinitThread:function(e,t){Atomics.store(l(),e+56>>2,1),Atomics.store(l(),e+60>>2,0),Le.runExitHandlers(),Atomics.store(l(),e+4>>2,t),Atomics.store(l(),e+0>>2,1),Ce(e+0,2147483647),sn(0,0,0)},threadExit:function(e){var t=Qt();t&&(Le.runExitHandlersAndDeinitThread(t,e),I&&postMessage({cmd:"exit"}))},threadCancel:function(){Le.runExitHandlersAndDeinitThread(Qt(),-1),postMessage({cmd:"cancelDone"})},terminateAllThreads:function(){for(var e in Le.pthreads)(a=Le.pthreads[e])&&a.worker&&Le.returnWorkerToPool(a.worker);Le.pthreads={};for(var t=0;t<Le.unusedWorkers.length;++t)(n=Le.unusedWorkers[t]).terminate();for(Le.unusedWorkers=[],t=0;t<Le.runningWorkers.length;++t){var n,a=(n=Le.runningWorkers[t]).pthread;Le.freeThreadData(a),n.terminate()}Le.runningWorkers=[]},freeThreadData:function(e){if(e){if(e.threadInfoStruct){var t=c()[e.threadInfoStruct+100>>2];c()[e.threadInfoStruct+100>>2]=0,$t(t),$t(e.threadInfoStruct)}e.threadInfoStruct=0,e.allocatedOwnStack&&e.stackBase&&$t(e.stackBase),e.stackBase=0,e.worker&&(e.worker.pthread=null)}},returnWorkerToPool:function(e){Le.runWithoutMainThreadQueuedCalls((function(){delete Le.pthreads[e.pthread.threadInfoStruct],Le.unusedWorkers.push(e),Le.runningWorkers.splice(Le.runningWorkers.indexOf(e),1),Le.freeThreadData(e.pthread),e.pthread=void 0}))},runWithoutMainThreadQueuedCalls:function(e){c()[fn>>2]=0;try{e()}finally{c()[fn>>2]=1}},receiveObjectTransfer:function(e){},loadWasmModuleToWorker:function(e,t){e.onmessage=function(n){var a=n.data,r=a.cmd;if(e.pthread&&(Le.currentProxiedOperationCallerThread=e.pthread.threadInfoStruct),a.targetThread&&a.targetThread!=Qt()){var s=Le.pthreads[a.targetThread];return s?s.worker.postMessage(n.data,a.transferList):console.error('Internal error! Worker sent a message "'+r+'" to target pthread '+a.targetThread+", but that thread no longer exists!"),void(Le.currentProxiedOperationCallerThread=void 0)}if("processQueuedMainThreadWork"===r)Zt();else if("spawnThread"===r)Rt(n.data);else if("cleanupThread"===r)Pe(a.thread);else if("killThread"===r)De(a.thread);else if("cancelThread"===r)Re(a.thread);else if("loaded"===r)e.loaded=!0,t&&t(e),e.runPthread&&(e.runPthread(),delete e.runPthread);else if("print"===r)O("Thread "+a.threadId+": "+a.text);else if("printErr"===r)C("Thread "+a.threadId+": "+a.text);else if("alert"===r)alert("Thread "+a.threadId+": "+a.text);else if("exit"===r)e.pthread&&Atomics.load(l(),e.pthread.threadInfoStruct+64>>2)&&Le.returnWorkerToPool(e);else if("exitProcess"===r)try{yn(a.returnCode)}catch(n){if(n instanceof hn)return;throw n}else"cancelDone"===r?Le.returnWorkerToPool(e):"objectTransfer"===r?Le.receiveObjectTransfer(n.data):"setimmediate"===n.data.target?e.postMessage(n.data):C("worker sent an unknown command "+r);Le.currentProxiedOperationCallerThread=void 0},e.onerror=function(e){C("pthread sent an error! "+e.filename+":"+e.lineno+": "+e.message)},w&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("exit",(function(e){}))),e.postMessage({cmd:"load",urlOrBlob:m.mainScriptUrlOrBlob||i,wasmMemory:R,wasmModule:P})},allocateUnusedWorker:function(){var e=N("tfjs-backend-wasm-threaded-simd.worker.js");Le.unusedWorkers.push(new Worker(e))},getNewWorker:function(){return 0==Le.unusedWorkers.length&&(Le.allocateUnusedWorker(),Le.loadWasmModuleToWorker(Le.unusedWorkers[0])),Le.unusedWorkers.length>0?Le.unusedWorkers.pop():null},busySpinWait:function(e){for(var t=performance.now()+e;performance.now()<t;);}};function He(e,t){dn(e,t),cn(e)}function Be(){return W}function Ue(e,t){return ae.get(e)(t)}function ze(e,t,n,a){ge("Assertion failed: "+Q(e)+", at: "+[t?Q(t):"unknown filename",n,a?Q(a):"unknown function"])}function je(e,t){_main(e,t)}function qe(e){return c()[Kt()>>2]=e,e}function Ve(e,t){if(I)return Je(1,1,e,t)}function Ge(e,t){if(e==t)postMessage({cmd:"processQueuedMainThreadWork"});else if(I)postMessage({targetThread:e,cmd:"processThreadQueue"});else{var n=Le.pthreads[e],a=n&&n.worker;if(!a)return;a.postMessage({cmd:"processThreadQueue"})}return 1}function $e(){ge()}function Ke(e,t,n){var a=nt(t,n);return Ne[e].apply(null,a)}function Xe(e,t){}function Qe(e,n,a){if(e<=0||e>t().length||!0&e)return-28;if(_){if(Atomics.load(c(),e>>2)!=n)return-6;var r=performance.now(),s=r+a;for(Atomics.exchange(c(),mn>>2,e);;){if((r=performance.now())>s)return Atomics.exchange(c(),mn>>2,0),-73;if(0==Atomics.exchange(c(),mn>>2,0))break;if(Zt(),Atomics.load(c(),e>>2)!=n)return-6;Atomics.exchange(c(),mn>>2,e)}return 0}var u=Atomics.wait(c(),e>>2,n,a);if("timed-out"===u)return-73;if("not-equal"===u)return-6;if("ok"===u)return 0;throw"Atomics.wait returned an unexpected value "+u}function Ye(e,t,n){o().copyWithin(e,t,t+n)}function Ze(){return w?u.cpus().length:navigator.hardwareConcurrency}function Je(e,t){for(var n=arguments.length-2,a=un(),r=n,s=ln(8*r),u=s>>3,i=0;i<n;i++){var o=arguments[2+i];d()[u+i]=o}var c=an(e,r,s,t);return cn(a),c}m.establishStackSpace=He,m.getNoExitRuntime=Be,m.invokeEntryPoint=Ue,We=w?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:I?function(){return performance.now()-m.__performance_now_clock_drift}:"undefined"!=typeof dateNow?dateNow:function(){return performance.now()};var et=[],tt=[];function nt(e,t){var n;for(tt.length=0,t>>=2;n=o()[e++];){var a=n<105;a&&1&t&&t++,tt.push(a?d()[t++>>1]:c()[t]),++t}return tt}function at(e,t,n){et.length=t;for(var a=n>>3,r=0;r<t;r++)et[r]=d()[a+r];return(e<0?Ne[-e-1]:jt[e]).apply(null,et)}function rt(){return o().length}function st(e){try{return R.grow(e-L.byteLength+65535>>>16),ne(R.buffer),1}catch(e){}}function ut(e){var t=rt();if(e<=t)return!1;var n=2147483648;if(e>n)return!1;for(var a=1;a<=4;a*=2){var r=t*(1+.2/a);if(r=Math.min(r,e+100663296),st(Math.min(n,te(Math.max(e,r),65536))))return!0}return!1}var it={inEventHandler:0,removeAllEventListeners:function(){for(var e=it.eventHandlers.length-1;e>=0;--e)it._removeHandler(e);it.eventHandlers=[],it.deferredCalls=[]},registerRemoveEventListeners:function(){it.removeEventListenersRegistered||(it.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(e,t,n){function a(e,t){if(e.length!=t.length)return!1;for(var n in e)if(e[n]!=t[n])return!1;return!0}for(var r in it.deferredCalls){var s=it.deferredCalls[r];if(s.targetFunction==e&&a(s.argsList,n))return}it.deferredCalls.push({targetFunction:e,precedence:t,argsList:n}),it.deferredCalls.sort((function(e,t){return e.precedence<t.precedence}))},removeDeferredCalls:function(e){for(var t=0;t<it.deferredCalls.length;++t)it.deferredCalls[t].targetFunction==e&&(it.deferredCalls.splice(t,1),--t)},canPerformEventHandlerRequests:function(){return it.inEventHandler&&it.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(it.canPerformEventHandlerRequests())for(var e=0;e<it.deferredCalls.length;++e){var t=it.deferredCalls[e];it.deferredCalls.splice(e,1),--e,t.targetFunction.apply(null,t.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(e,t){for(var n=0;n<it.eventHandlers.length;++n)it.eventHandlers[n].target!=e||t&&t!=it.eventHandlers[n].eventTypeString||it._removeHandler(n--)},_removeHandler:function(e){var t=it.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),it.eventHandlers.splice(e,1)},registerOrRemoveHandler:function(e){var t=function(t){++it.inEventHandler,it.currentEventHandler=e,it.runDeferredCalls(),e.handlerFunc(t),it.runDeferredCalls(),--it.inEventHandler};if(e.callbackfunc)e.eventListenerFunc=t,e.target.addEventListener(e.eventTypeString,t,e.useCapture),it.eventHandlers.push(e),it.registerRemoveEventListeners();else for(var n=0;n<it.eventHandlers.length;++n)it.eventHandlers[n].target==e.target&&it.eventHandlers[n].eventTypeString==e.eventTypeString&&it._removeHandler(n--)},queueEventHandlerOnThread_iiii:function(e,t,n,a,r){var s=un(),u=ln(12);c()[u>>2]=n,c()[u+4>>2]=a,c()[u+8>>2]=r,rn(0,e,637534208,t,a,u),cn(s)},getTargetThreadForEventCallback:function(e){switch(e){case 1:return 0;case 2:return Le.currentProxiedOperationCallerThread;default:return e}},getNodeNameForTarget:function(e){return e?e==window?"#window":e==screen?"#screen":e&&e.nodeName?e.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function ot(e){var t=J(e)+1,n=Gt(t);return Z(e,n,t),n}function ct(e,t,n,a){var r=un(),s=ln(12),u=0;t&&(u=ot(t)),c()[s>>2]=u,c()[s+4>>2]=n,c()[s+8>>2]=a,rn(0,e,657457152,0,u,s),cn(r)}function lt(e,t,n,a){ct(e,t=t?Q(t):"",n,a)}function dt(e){return e>2?Q(e):e}var pt=[0,"undefined"!=typeof document?document:0,"undefined"!=typeof window?window:0];function ft(e){return e=dt(e),pt[e]||("undefined"!=typeof document?document.querySelector(e):void 0)}function mt(e){return ft(e)}function ht(e,t,n){var a=mt(e);if(!a)return-4;if(a.canvasSharedPtr&&(c()[a.canvasSharedPtr>>2]=t,c()[a.canvasSharedPtr+4>>2]=n),!a.offscreenCanvas&&a.controlTransferredOffscreen)return a.canvasSharedPtr?(lt(c()[a.canvasSharedPtr+8>>2],e,t,n),1):-4;a.offscreenCanvas&&(a=a.offscreenCanvas);var r=!1;if(a.GLctxObject&&a.GLctxObject.GLctx){var s=a.GLctxObject.GLctx.getParameter(2978);r=0===s[0]&&0===s[1]&&s[2]===a.width&&s[3]===a.height}return a.width=t,a.height=n,r&&a.GLctxObject.GLctx.viewport(0,0,t,n),0}function bt(e,t,n){return I?Je(2,1,e,t,n):ht(e,t,n)}function yt(e,t,n){return mt(e)?ht(e,t,n):bt(e,t,n)}function _t(e){}function gt(e,t){}function wt(e){var t=e.getExtension("ANGLE_instanced_arrays");if(t)return e.vertexAttribDivisor=function(e,n){t.vertexAttribDivisorANGLE(e,n)},e.drawArraysInstanced=function(e,n,a,r){t.drawArraysInstancedANGLE(e,n,a,r)},e.drawElementsInstanced=function(e,n,a,r,s){t.drawElementsInstancedANGLE(e,n,a,r,s)},1}function kt(e){var t=e.getExtension("OES_vertex_array_object");if(t)return e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)},1}function It(e){var t=e.getExtension("WEBGL_draw_buffers");if(t)return e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)},1}function vt(e){return!!(e.multiDrawWebgl=e.getExtension("WEBGL_multi_draw"))}var St={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],contexts:{},offscreenCanvases:{},timerQueriesEXT:[],programInfos:{},stringCache:{},unpackAlignment:4,recordError:function(e){St.lastError||(St.lastError=e)},getNewId:function(e){for(var t=St.counter++,n=e.length;n<t;n++)e[n]=null;return t},getSource:function(e,t,n,a){for(var r="",s=0;s<t;++s){var u=a?c()[a+4*s>>2]:-1;r+=Q(c()[n+4*s>>2],u<0?void 0:u)}return r},createContext:function(e,t){var n=e.getContext("webgl",t);return n?St.registerContext(n,t):0},registerContext:function(e,t){var n=Gt(8);c()[n+4>>2]=Qt();var a={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=a),St.contexts[n]=a,("undefined"==typeof t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&St.initExtensions(a),n},makeContextCurrent:function(e){return St.currentContext=St.contexts[e],m.ctx=xt=St.currentContext&&St.currentContext.GLctx,!(e&&!xt)},getContext:function(e){return St.contexts[e]},deleteContext:function(e){St.currentContext===St.contexts[e]&&(St.currentContext=null),"object"==typeof it&&it.removeAllHandlersOnTarget(St.contexts[e].GLctx.canvas),St.contexts[e]&&St.contexts[e].GLctx.canvas&&(St.contexts[e].GLctx.canvas.GLctxObject=void 0),$t(St.contexts[e].handle),St.contexts[e]=null},initExtensions:function(e){if(e||(e=St.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t=e.GLctx;wt(t),kt(t),It(t),t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query"),vt(t),(t.getSupportedExtensions()||[]).forEach((function(e){e.indexOf("lose_context")<0&&e.indexOf("debug")<0&&t.getExtension(e)}))}},populateUniformTable:function(e){for(var t=St.programs[e],n=St.programInfos[e]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1},a=n.uniforms,r=xt.getProgramParameter(t,35718),s=0;s<r;++s){var u=xt.getActiveUniform(t,s),i=u.name;n.maxUniformLength=Math.max(n.maxUniformLength,i.length+1),"]"==i.slice(-1)&&(i=i.slice(0,i.lastIndexOf("[")));var o=xt.getUniformLocation(t,i);if(o){var c=St.getNewId(St.uniforms);a[i]=[u.size,c],St.uniforms[c]=o;for(var l=1;l<u.size;++l){var d=i+"["+l+"]";o=xt.getUniformLocation(t,d),c=St.getNewId(St.uniforms),St.uniforms[c]=o}}}}},At=["default","low-power","high-performance"];function Mt(e,t){var n=t>>2,a=c()[n+6],r={alpha:!!c()[n+0],depth:!!c()[n+1],stencil:!!c()[n+2],antialias:!!c()[n+3],premultipliedAlpha:!!c()[n+4],preserveDrawingBuffer:!!c()[n+5],powerPreference:At[a],failIfMajorPerformanceCaveat:!!c()[n+7],majorVersion:c()[n+8],minorVersion:c()[n+9],enableExtensionsByDefault:c()[n+10],explicitSwapControl:c()[n+11],proxyContextToMainThread:c()[n+12],renderViaOffscreenBackBuffer:c()[n+13]},s=mt(e);return s?r.explicitSwapControl?0:St.createContext(s,r):0}function Et(e,t){return Mt(e,t)}var xt,Nt={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=Nt.buffers[e];0===t||10===t?((1===e?O:C)(X(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return Nt.varargs+=4,c()[Nt.varargs-4>>2]},getStr:function(e){return Q(e)},get64:function(e,t){return e}};function Ft(e){return I?Je(3,1,e):0}function Tt(e,t,n,a,r){if(I)return Je(4,1,e,t,n,a,r)}function Ot(e,t,n,a){if(I)return Je(5,1,e,t,n,a);for(var r=0,s=0;s<n;s++){for(var u=c()[t+8*s>>2],i=c()[t+(8*s+4)>>2],l=0;l<i;l++)Nt.printChar(e,o()[u+l]);r+=i}return c()[a>>2]=r,0}function Ct(e){var t=Le.threadExitHandlers.pop();e&&t()}function Dt(e,t){Le.threadExitHandlers.push((function(){ae.get(e)(t)}))}function Rt(e){if(I)throw"Internal Error! spawnThread() can only ever be called from main application thread!";var t=Le.getNewWorker();if(void 0!==t.pthread)throw"Internal error!";if(!e.pthread_ptr)throw"Internal error, no pthread ptr!";Le.runningWorkers.push(t);for(var n=Gt(512),a=0;a<128;++a)c()[n+4*a>>2]=0;var r=e.stackBase+e.stackSize,s=Le.pthreads[e.pthread_ptr]={worker:t,stackBase:e.stackBase,stackSize:e.stackSize,allocatedOwnStack:e.allocatedOwnStack,threadInfoStruct:e.pthread_ptr},u=s.threadInfoStruct>>2;Atomics.store(l(),u+16,e.detached),Atomics.store(l(),u+25,n),Atomics.store(l(),u+10,s.threadInfoStruct),Atomics.store(l(),u+20,e.stackSize),Atomics.store(l(),u+19,r),Atomics.store(l(),u+26,e.stackSize),Atomics.store(l(),u+28,r),Atomics.store(l(),u+29,e.detached);var i=Xt()+40;Atomics.store(l(),u+43,i),t.pthread=s;var o={cmd:"run",start_routine:e.startRoutine,arg:e.arg,threadInfoStruct:e.pthread_ptr,stackBase:e.stackBase,stackSize:e.stackSize};t.runPthread=function(){o.time=performance.now(),t.postMessage(o,e.transferList)},t.loaded&&(t.runPthread(),delete t.runPthread)}function Pt(e,t,n,a){if("undefined"==typeof SharedArrayBuffer)return C("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;if(!e)return C("pthread_create called with a null thread pointer!"),28;var r=[];if(I&&0===r.length)return nn(687865856,e,t,n,a);var s=0,u=0,i=0;t&&-1!=t?(s=c()[t>>2],s+=81920,u=c()[t+8>>2],i=0!==c()[t+12>>2]):s=2097152;var o=0==u;o?u=pn(16,s):V((u-=s)>0);for(var d=Gt(228),p=0;p<57;++p)l()[(d>>2)+p]=0;c()[e>>2]=d,c()[d+12>>2]=d;var f=d+152;c()[f>>2]=f;var m={stackBase:u,stackSize:s,allocatedOwnStack:o,detached:i,startRoutine:n,pthread_ptr:d,arg:a,transferList:r};return I?(m.cmd="spawnThread",postMessage(m,r)):Rt(m),0}function Wt(){if(I){var e=Qt();if(e&&!Atomics.load(l(),e+56>>2)&&2==Atomics.load(l(),e+0>>2))throw"Canceled!"}}function Lt(){w||g||D("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function Ht(e,t,n){if(!e)return C("pthread_join attempted on a null thread pointer!"),Oe.ESRCH;if(I&&Qt()==e)return C("PThread "+e+" is attempting to join to itself!"),Oe.EDEADLK;if(!I&&en()==e)return C("Main thread "+e+" is attempting to join to itself!"),Oe.EDEADLK;if(c()[e+12>>2]!==e)return C("pthread_join attempted on thread "+e+", which does not point to a valid thread, or does not exist anymore!"),Oe.ESRCH;if(Atomics.load(l(),e+64>>2))return C("Attempted to join thread "+e+", which was already detached!"),Oe.EINVAL;for(n&&Lt();;){var a=Atomics.load(l(),e+0>>2);if(1==a){var r=Atomics.load(l(),e+4>>2);return t&&(c()[t>>2]=r),Atomics.store(l(),e+64>>2,1),I?postMessage({cmd:"cleanupThread",thread:e}):Pe(e),0}if(!n)return Oe.EBUSY;Wt(),I||Zt(),Qe(e+0,a,I?100:1)}}function Bt(e,t){return Ht(e,t,!0)}function Ut(e){if(I)return Je(6,1,e);switch(e){case 30:return 16384;case 85:return 131072;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:case 80:case 81:case 79:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return qe(28),-1}I||Le.initMainThreadBlock();var zt,jt=[null,Ve,bt,Ft,Tt,Ot,Ut],qt={e:ze,r:je,x:Ge,b:$e,y:Ke,j:Xe,d:Qe,c:Ce,f:We,p:Ye,A:Ze,u:at,q:ut,v:yt,i:_t,s:gt,w:Et,l:Ft,n:Tt,g:Ot,o:Fe,a:R||m.wasmMemory,z:Ct,k:Dt,h:Pt,m:Bt,t:Ut},Vt=(xe(),m.___wasm_call_ctors=function(){return(Vt=m.___wasm_call_ctors=m.asm.B).apply(null,arguments)}),Gt=(m._init=function(){return(m._init=m.asm.C).apply(null,arguments)},m._init_with_threads_count=function(){return(m._init_with_threads_count=m.asm.D).apply(null,arguments)},m._get_threads_count=function(){return(m._get_threads_count=m.asm.E).apply(null,arguments)},m._register_tensor=function(){return(m._register_tensor=m.asm.F).apply(null,arguments)},m._dispose_data=function(){return(m._dispose_data=m.asm.G).apply(null,arguments)},m._dispose=function(){return(m._dispose=m.asm.H).apply(null,arguments)},m._Abs=function(){return(m._Abs=m.asm.J).apply(null,arguments)},m._Add=function(){return(m._Add=m.asm.K).apply(null,arguments)},m._AddN=function(){return(m._AddN=m.asm.L).apply(null,arguments)},m._All=function(){return(m._All=m.asm.M).apply(null,arguments)},m._Any=function(){return(m._Any=m.asm.N).apply(null,arguments)},m._ArgMax=function(){return(m._ArgMax=m.asm.O).apply(null,arguments)},m._AvgPool=function(){return(m._AvgPool=m.asm.P).apply(null,arguments)},m._BatchMatMul=function(){return(m._BatchMatMul=m.asm.Q).apply(null,arguments)},m._Ceil=function(){return(m._Ceil=m.asm.R).apply(null,arguments)},m._ClipByValue=function(){return(m._ClipByValue=m.asm.S).apply(null,arguments)},m._Conv2D=function(){return(m._Conv2D=m.asm.T).apply(null,arguments)},m._Conv2DBackpropInput=function(){return(m._Conv2DBackpropInput=m.asm.U).apply(null,arguments)},m._Cos=function(){return(m._Cos=m.asm.V).apply(null,arguments)},m._Cosh=function(){return(m._Cosh=m.asm.W).apply(null,arguments)},m._CropAndResize=function(){return(m._CropAndResize=m.asm.X).apply(null,arguments)},m._Cumsum=function(){return(m._Cumsum=m.asm.Y).apply(null,arguments)},m._DepthToSpace=function(){return(m._DepthToSpace=m.asm.Z).apply(null,arguments)},m._DepthwiseConv2dNative=function(){return(m._DepthwiseConv2dNative=m.asm._).apply(null,arguments)},m._Elu=function(){return(m._Elu=m.asm.$).apply(null,arguments)},m._Equal=function(){return(m._Equal=m.asm.aa).apply(null,arguments)},m._Exp=function(){return(m._Exp=m.asm.ba).apply(null,arguments)},m._FlipLeftRight=function(){return(m._FlipLeftRight=m.asm.ca).apply(null,arguments)},m._Floor=function(){return(m._Floor=m.asm.da).apply(null,arguments)},m._FloorDiv=function(){return(m._FloorDiv=m.asm.ea).apply(null,arguments)},m._FusedBatchNorm=function(){return(m._FusedBatchNorm=m.asm.fa).apply(null,arguments)},m._FusedConv2D=function(){return(m._FusedConv2D=m.asm.ga).apply(null,arguments)},m._FusedDepthwiseConv2D=function(){return(m._FusedDepthwiseConv2D=m.asm.ha).apply(null,arguments)},m._Gather=function(){return(m._Gather=m.asm.ia).apply(null,arguments)},m._GatherNd=function(){return(m._GatherNd=m.asm.ja).apply(null,arguments)},m._Greater=function(){return(m._Greater=m.asm.ka).apply(null,arguments)},m._GreaterEqual=function(){return(m._GreaterEqual=m.asm.la).apply(null,arguments)},m._LeakyRelu=function(){return(m._LeakyRelu=m.asm.ma).apply(null,arguments)},m._Less=function(){return(m._Less=m.asm.na).apply(null,arguments)},m._LessEqual=function(){return(m._LessEqual=m.asm.oa).apply(null,arguments)},m._Log=function(){return(m._Log=m.asm.pa).apply(null,arguments)},m._LogicalAnd=function(){return(m._LogicalAnd=m.asm.qa).apply(null,arguments)},m._Max=function(){return(m._Max=m.asm.ra).apply(null,arguments)},m._MaxPool=function(){return(m._MaxPool=m.asm.sa).apply(null,arguments)},m._Maximum=function(){return(m._Maximum=m.asm.ta).apply(null,arguments)},m._Mean=function(){return(m._Mean=m.asm.ua).apply(null,arguments)},m._Min=function(){return(m._Min=m.asm.va).apply(null,arguments)},m._Minimum=function(){return(m._Minimum=m.asm.wa).apply(null,arguments)},m._MirrorPad=function(){return(m._MirrorPad=m.asm.xa).apply(null,arguments)},m._Multiply=function(){return(m._Multiply=m.asm.ya).apply(null,arguments)},m._Neg=function(){return(m._Neg=m.asm.za).apply(null,arguments)},m._NonMaxSuppressionV3=function(){return(m._NonMaxSuppressionV3=m.asm.Aa).apply(null,arguments)},m._NonMaxSuppressionV4=function(){return(m._NonMaxSuppressionV4=m.asm.Ba).apply(null,arguments)},m._NonMaxSuppressionV5=function(){return(m._NonMaxSuppressionV5=m.asm.Ca).apply(null,arguments)},m._NotEqual=function(){return(m._NotEqual=m.asm.Da).apply(null,arguments)},m._OneHot=function(){return(m._OneHot=m.asm.Ea).apply(null,arguments)},m._PadV2=function(){return(m._PadV2=m.asm.Fa).apply(null,arguments)},m._Pow=function(){return(m._Pow=m.asm.Ga).apply(null,arguments)},m._Prelu=function(){return(m._Prelu=m.asm.Ha).apply(null,arguments)},m._Prod=function(){return(m._Prod=m.asm.Ia).apply(null,arguments)},m._RealDiv=function(){return(m._RealDiv=m.asm.Ja).apply(null,arguments)},m._Relu=function(){return(m._Relu=m.asm.Ka).apply(null,arguments)},m._Relu6=function(){return(m._Relu6=m.asm.La).apply(null,arguments)},m._ResizeBilinear=function(){return(m._ResizeBilinear=m.asm.Ma).apply(null,arguments)},m._Reverse=function(){return(m._Reverse=m.asm.Na).apply(null,arguments)},m._RotateWithOffset=function(){return(m._RotateWithOffset=m.asm.Oa).apply(null,arguments)},m._Round=function(){return(m._Round=m.asm.Pa).apply(null,arguments)},m._Rsqrt=function(){return(m._Rsqrt=m.asm.Qa).apply(null,arguments)},m._ScatterNd=function(){return(m._ScatterNd=m.asm.Ra).apply(null,arguments)},m._SelectV2=function(){return(m._SelectV2=m.asm.Sa).apply(null,arguments)},m._Sigmoid=function(){return(m._Sigmoid=m.asm.Ta).apply(null,arguments)},m._Sin=function(){return(m._Sin=m.asm.Ua).apply(null,arguments)},m._Softmax=function(){return(m._Softmax=m.asm.Va).apply(null,arguments)},m._Sqrt=function(){return(m._Sqrt=m.asm.Wa).apply(null,arguments)},m._Square=function(){return(m._Square=m.asm.Xa).apply(null,arguments)},m._SquaredDifference=function(){return(m._SquaredDifference=m.asm.Ya).apply(null,arguments)},m._Step=function(){return(m._Step=m.asm.Za).apply(null,arguments)},m._StridedSlice=function(){return(m._StridedSlice=m.asm._a).apply(null,arguments)},m._Sub=function(){return(m._Sub=m.asm.$a).apply(null,arguments)},m._Sum=function(){return(m._Sum=m.asm.ab).apply(null,arguments)},m._Tan=function(){return(m._Tan=m.asm.bb).apply(null,arguments)},m._Tanh=function(){return(m._Tanh=m.asm.cb).apply(null,arguments)},m._Tile=function(){return(m._Tile=m.asm.db).apply(null,arguments)},m._TopK=function(){return(m._TopK=m.asm.eb).apply(null,arguments)},m._Transform=function(){return(m._Transform=m.asm.fb).apply(null,arguments)},m._Transpose=function(){return(m._Transpose=m.asm.gb).apply(null,arguments)},m.__FusedMatMul=function(){return(m.__FusedMatMul=m.asm.hb).apply(null,arguments)},m._malloc=function(){return(Gt=m._malloc=m.asm.ib).apply(null,arguments)}),$t=m._free=function(){return($t=m._free=m.asm.jb).apply(null,arguments)},Kt=m.___errno_location=function(){return(Kt=m.___errno_location=m.asm.kb).apply(null,arguments)},Xt=m._emscripten_get_global_libc=function(){return(Xt=m._emscripten_get_global_libc=m.asm.lb).apply(null,arguments)},Qt=m._pthread_self=function(){return(Qt=m._pthread_self=m.asm.mb).apply(null,arguments)},Yt=m.___pthread_tsd_run_dtors=function(){return(Yt=m.___pthread_tsd_run_dtors=m.asm.nb).apply(null,arguments)},Zt=m._emscripten_main_thread_process_queued_calls=function(){return(Zt=m._emscripten_main_thread_process_queued_calls=m.asm.ob).apply(null,arguments)},Jt=(m._emscripten_current_thread_process_queued_calls=function(){return(m._emscripten_current_thread_process_queued_calls=m.asm.pb).apply(null,arguments)},m._emscripten_register_main_browser_thread_id=function(){return(Jt=m._emscripten_register_main_browser_thread_id=m.asm.qb).apply(null,arguments)}),en=m._emscripten_main_browser_thread_id=function(){return(en=m._emscripten_main_browser_thread_id=m.asm.rb).apply(null,arguments)},tn=m.__emscripten_do_dispatch_to_thread=function(){return(tn=m.__emscripten_do_dispatch_to_thread=m.asm.sb).apply(null,arguments)},nn=m._emscripten_sync_run_in_main_thread_4=function(){return(nn=m._emscripten_sync_run_in_main_thread_4=m.asm.tb).apply(null,arguments)},an=m._emscripten_run_in_main_runtime_thread_js=function(){return(an=m._emscripten_run_in_main_runtime_thread_js=m.asm.ub).apply(null,arguments)},rn=m.__emscripten_call_on_thread=function(){return(rn=m.__emscripten_call_on_thread=m.asm.vb).apply(null,arguments)},sn=(m._emscripten_tls_init=function(){return(m._emscripten_tls_init=m.asm.wb).apply(null,arguments)},m.__emscripten_thread_init=function(){return(sn=m.__emscripten_thread_init=m.asm.xb).apply(null,arguments)}),un=m.stackSave=function(){return(un=m.stackSave=m.asm.yb).apply(null,arguments)},cn=m.stackRestore=function(){return(cn=m.stackRestore=m.asm.zb).apply(null,arguments)},ln=m.stackAlloc=function(){return(ln=m.stackAlloc=m.asm.Ab).apply(null,arguments)},dn=m._emscripten_stack_set_limits=function(){return(dn=m._emscripten_stack_set_limits=m.asm.Bb).apply(null,arguments)},pn=m._memalign=function(){return(pn=m._memalign=m.asm.Cb).apply(null,arguments)},fn=m.__emscripten_allow_main_runtime_queued_calls=10512,mn=m.__emscripten_main_thread_futex=12148;function hn(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function bn(e){if(!(he>0)){if(I)return p(m),le(),void postMessage({cmd:"loaded"});ce(),he>0||(m.setStatus?(m.setStatus("Running..."),setTimeout((function(){setTimeout((function(){m.setStatus("")}),1),t()}),1)):t())}function t(){zt||(zt=!0,m.calledRun=!0,q||(le(),de(),p(m),m.onRuntimeInitialized&&m.onRuntimeInitialized(),pe()))}}function yn(e,t){if(!t||!W||0!==e){if(!t&&I)throw postMessage({cmd:"exitProcess",returnCode:e}),new hn(e);W||(Le.terminateAllThreads(),m.onExit&&m.onExit(e),q=!0),y(e,new hn(e))}}if(m.cwrap=K,m.PThread=Le,m.PThread=Le,m.wasmMemory=R,m.ExitStatus=hn,be=function e(){zt||bn(),zt||(be=e)},m.run=bn,m.preInit)for("function"==typeof m.preInit&&(m.preInit=[m.preInit]);m.preInit.length>0;)m.preInit.pop()();return I&&(W=!1,Le.initWorker()),bn(),e.ready});e.exports=o}));var dn=cn((function(e,t){var r,s=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(r=r||__filename),function(e){var t,s,u="undefined"!=typeof(e=e||{})?e:{};u.ready=new Promise((function(e,n){t=e,s=n}));var i,o={};for(i in u)u.hasOwnProperty(i)&&(o[i]=u[i]);var c=!1,l=!1,d=!1,p=!1;c="object"==typeof window,l="function"==typeof importScripts,d="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,p=!c&&!d&&!l;var f,m,h,b,y,_="";function g(e){return u.locateFile?u.locateFile(e,_):_+e}d?(_=l?n.dirname(_)+"/":__dirname+"/",f=function(e,t){return b||(b=a),y||(y=n),e=y.normalize(e),b.readFileSync(e,t?null:"utf8")},h=function(e){var t=f(e,!0);return t.buffer||(t=new Uint8Array(t)),A(t.buffer),t},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof Ce))throw e})),process.on("unhandledRejection",ne),u.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(f=function(e){return read(e)}),h=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(A("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs&&scriptArgs,"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(c||l)&&(l?_=self.location.href:"undefined"!=typeof document&&document.currentScript&&(_=document.currentScript.src),r&&(_=r),_=0!==_.indexOf("blob:")?_.substr(0,_.lastIndexOf("/")+1):"",f=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},l&&(h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),m=function(e,t,n){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)});var w,k,I=u.print||console.log.bind(console),v=u.printErr||console.warn.bind(console);for(i in o)o.hasOwnProperty(i)&&(u[i]=o[i]);o=null,u.arguments&&u.arguments,u.thisProgram&&u.thisProgram,u.quit&&u.quit,u.wasmBinary&&(w=u.wasmBinary),u.noExitRuntime,"object"!=typeof WebAssembly&&ne("no native wasm support detected");var S=!1;function A(e,t){e||ne("Assertion failed: "+t)}function M(e){var t=u["_"+e];return A(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function E(e,t,n,a,r){var s={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);W(e,t=Oe(n),n)}return t},array:function(e){var t=Oe(e.length);return L(e,t),t}},u=M(e),i=[],o=0;if(a)for(var c=0;c<a.length;c++){var l=s[n[c]];l?(0===o&&(o=Fe()),i[c]=l(a[c])):i[c]=a[c]}var d=u.apply(null,i);return d=function(e){return"string"===t?R(e):"boolean"===t?Boolean(e):e}(d),0!==o&&Te(o),d}function x(e,t,n,a){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!a?M(e):function(){return E(e,t,n,arguments)}}var N,F,T,O,C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function D(e,t,n){for(var a=t+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.subarray&&C)return C.decode(e.subarray(t,r));for(var s="";t<r;){var u=e[t++];if(128&u){var i=63&e[t++];if(192!=(224&u)){var o=63&e[t++];if((u=224==(240&u)?(15&u)<<12|i<<6|o:(7&u)<<18|i<<12|o<<6|63&e[t++])<65536)s+=String.fromCharCode(u);else{var c=u-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&u)<<6|i)}else s+=String.fromCharCode(u)}return s}function R(e,t){return e?D(T,e,t):""}function P(e,t,n,a){if(!(a>0))return 0;for(var r=n,s=n+a-1,u=0;u<e.length;++u){var i=e.charCodeAt(u);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++u)),i<=127){if(n>=s)break;t[n++]=i}else if(i<=2047){if(n+1>=s)break;t[n++]=192|i>>6,t[n++]=128|63&i}else if(i<=65535){if(n+2>=s)break;t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i}else{if(n+3>=s)break;t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i}}return t[n]=0,n-r}function W(e,t,n){return P(e,T,t,n)}function L(e,t){F.set(e,t)}function H(e,t){return e%t>0&&(e+=t-e%t),e}function B(e){N=e,u.HEAP8=F=new Int8Array(e),u.HEAP16=new Int16Array(e),u.HEAP32=O=new Int32Array(e),u.HEAPU8=T=new Uint8Array(e),u.HEAPU16=new Uint16Array(e),u.HEAPU32=new Uint32Array(e),u.HEAPF32=new Float32Array(e),u.HEAPF64=new Float64Array(e)}u.INITIAL_MEMORY;var U,z=[],j=[],q=[],V=[];function G(){if(u.preRun)for("function"==typeof u.preRun&&(u.preRun=[u.preRun]);u.preRun.length;)Q(u.preRun.shift());pe(z)}function $(){pe(j)}function K(){pe(q)}function X(){if(u.postRun)for("function"==typeof u.postRun&&(u.postRun=[u.postRun]);u.postRun.length;)Y(u.postRun.shift());pe(V)}function Q(e){z.unshift(e)}function Y(e){V.unshift(e)}j.push({func:function(){xe()}});var Z=0,J=null;function ee(e){Z++,u.monitorRunDependencies&&u.monitorRunDependencies(Z)}function te(e){if(Z--,u.monitorRunDependencies&&u.monitorRunDependencies(Z),0==Z&&J){var t=J;J=null,t()}}function ne(e){u.onAbort&&u.onAbort(e),v(e+=""),S=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw s(t),t}function ae(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}u.preloadedImages={},u.preloadedAudios={};var re="data:application/octet-stream;base64,";function se(e){return ae(e,re)}var ue="file://";function ie(e){return ae(e,ue)}var oe="tfjs-backend-wasm.wasm";function ce(e){try{if(e==oe&&w)return new Uint8Array(w);if(h)return h(e);throw"both async and sync fetching of the wasm failed"}catch(e){ne(e)}}function le(){if(!w&&(c||l)){if("function"==typeof fetch&&!ie(oe))return fetch(oe,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+oe+"'";return e.arrayBuffer()})).catch((function(){return ce(oe)}));if(m)return new Promise((function(e,t){m(oe,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ce(oe)}))}function de(){var e={a:Ee};function t(e,t){var n=e.exports;u.asm=n,B((k=u.asm.j).buffer),U=u.asm.r,te()}function n(e){t(e.instance)}function a(t){return le().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){v("failed to asynchronously prepare wasm: "+e),ne(e)}))}if(ee(),u.instantiateWasm)try{return u.instantiateWasm(e,t)}catch(e){return v("Module.instantiateWasm callback failed with error: "+e),!1}return(w||"function"!=typeof WebAssembly.instantiateStreaming||se(oe)||ie(oe)||"function"!=typeof fetch?a(n):fetch(oe,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return v("wasm streaming compile failed: "+e),v("falling back to ArrayBuffer instantiation"),a(n)}))}))).catch(s),{}}function pe(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?U.get(n)():U.get(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(u)}}function fe(){ne()}function me(e,t,n){T.copyWithin(e,t,t+n)}function he(){return T.length}function be(e){try{return k.grow(e-N.byteLength+65535>>>16),B(k.buffer),1}catch(e){}}function ye(e){var t=he(),n=2147483648;if(e>n)return!1;for(var a=1;a<=4;a*=2){var r=t*(1+.2/a);if(r=Math.min(r,e+100663296),be(Math.min(n,H(Math.max(e,r),65536))))return!0}return!1}se(oe)||(oe=g(oe));var _e={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=_e.buffers[e];0===t||10===t?((1===e?I:v)(D(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return _e.varargs+=4,O[_e.varargs-4>>2]},getStr:function(e){return R(e)},get64:function(e,t){return e}};function ge(e){return 0}function we(e,t,n,a,r){}function ke(e,t,n,a){for(var r=0,s=0;s<n;s++){for(var u=O[t+8*s>>2],i=O[t+(8*s+4)>>2],o=0;o<i;o++)_e.printChar(e,T[u+o]);r+=i}return O[a>>2]=r,0}function Ie(){return 6}function ve(){return 28}function Se(e){return O[Ne()>>2]=e,e}function Ae(e){switch(e){case 30:return 16384;case 85:return 131072;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:case 80:case 81:case 79:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return Se(28),-1}var Me,Ee={a:fe,d:me,e:ye,f:ge,c:we,b:ke,h:Ie,g:ve,i:Ae},xe=(de(),u.___wasm_call_ctors=function(){return(xe=u.___wasm_call_ctors=u.asm.k).apply(null,arguments)}),Ne=(u._init=function(){return(u._init=u.asm.l).apply(null,arguments)},u._init_with_threads_count=function(){return(u._init_with_threads_count=u.asm.m).apply(null,arguments)},u._get_threads_count=function(){return(u._get_threads_count=u.asm.n).apply(null,arguments)},u._register_tensor=function(){return(u._register_tensor=u.asm.o).apply(null,arguments)},u._dispose_data=function(){return(u._dispose_data=u.asm.p).apply(null,arguments)},u._dispose=function(){return(u._dispose=u.asm.q).apply(null,arguments)},u._Abs=function(){return(u._Abs=u.asm.s).apply(null,arguments)},u._Add=function(){return(u._Add=u.asm.t).apply(null,arguments)},u._AddN=function(){return(u._AddN=u.asm.u).apply(null,arguments)},u._All=function(){return(u._All=u.asm.v).apply(null,arguments)},u._Any=function(){return(u._Any=u.asm.w).apply(null,arguments)},u._ArgMax=function(){return(u._ArgMax=u.asm.x).apply(null,arguments)},u._AvgPool=function(){return(u._AvgPool=u.asm.y).apply(null,arguments)},u._BatchMatMul=function(){return(u._BatchMatMul=u.asm.z).apply(null,arguments)},u._Ceil=function(){return(u._Ceil=u.asm.A).apply(null,arguments)},u._ClipByValue=function(){return(u._ClipByValue=u.asm.B).apply(null,arguments)},u._Conv2D=function(){return(u._Conv2D=u.asm.C).apply(null,arguments)},u._Conv2DBackpropInput=function(){return(u._Conv2DBackpropInput=u.asm.D).apply(null,arguments)},u._Cos=function(){return(u._Cos=u.asm.E).apply(null,arguments)},u._Cosh=function(){return(u._Cosh=u.asm.F).apply(null,arguments)},u._CropAndResize=function(){return(u._CropAndResize=u.asm.G).apply(null,arguments)},u._Cumsum=function(){return(u._Cumsum=u.asm.H).apply(null,arguments)},u._DepthToSpace=function(){return(u._DepthToSpace=u.asm.I).apply(null,arguments)},u._DepthwiseConv2dNative=function(){return(u._DepthwiseConv2dNative=u.asm.J).apply(null,arguments)},u._Elu=function(){return(u._Elu=u.asm.K).apply(null,arguments)},u._Equal=function(){return(u._Equal=u.asm.L).apply(null,arguments)},u._Exp=function(){return(u._Exp=u.asm.M).apply(null,arguments)},u._FlipLeftRight=function(){return(u._FlipLeftRight=u.asm.N).apply(null,arguments)},u._Floor=function(){return(u._Floor=u.asm.O).apply(null,arguments)},u._FloorDiv=function(){return(u._FloorDiv=u.asm.P).apply(null,arguments)},u._FusedBatchNorm=function(){return(u._FusedBatchNorm=u.asm.Q).apply(null,arguments)},u._FusedConv2D=function(){return(u._FusedConv2D=u.asm.R).apply(null,arguments)},u._FusedDepthwiseConv2D=function(){return(u._FusedDepthwiseConv2D=u.asm.S).apply(null,arguments)},u._Gather=function(){return(u._Gather=u.asm.T).apply(null,arguments)},u._GatherNd=function(){return(u._GatherNd=u.asm.U).apply(null,arguments)},u._Greater=function(){return(u._Greater=u.asm.V).apply(null,arguments)},u._GreaterEqual=function(){return(u._GreaterEqual=u.asm.W).apply(null,arguments)},u._LeakyRelu=function(){return(u._LeakyRelu=u.asm.X).apply(null,arguments)},u._Less=function(){return(u._Less=u.asm.Y).apply(null,arguments)},u._LessEqual=function(){return(u._LessEqual=u.asm.Z).apply(null,arguments)},u._Log=function(){return(u._Log=u.asm._).apply(null,arguments)},u._LogicalAnd=function(){return(u._LogicalAnd=u.asm.$).apply(null,arguments)},u._Max=function(){return(u._Max=u.asm.aa).apply(null,arguments)},u._MaxPool=function(){return(u._MaxPool=u.asm.ba).apply(null,arguments)},u._Maximum=function(){return(u._Maximum=u.asm.ca).apply(null,arguments)},u._Mean=function(){return(u._Mean=u.asm.da).apply(null,arguments)},u._Min=function(){return(u._Min=u.asm.ea).apply(null,arguments)},u._Minimum=function(){return(u._Minimum=u.asm.fa).apply(null,arguments)},u._MirrorPad=function(){return(u._MirrorPad=u.asm.ga).apply(null,arguments)},u._Multiply=function(){return(u._Multiply=u.asm.ha).apply(null,arguments)},u._Neg=function(){return(u._Neg=u.asm.ia).apply(null,arguments)},u._NonMaxSuppressionV3=function(){return(u._NonMaxSuppressionV3=u.asm.ja).apply(null,arguments)},u._NonMaxSuppressionV4=function(){return(u._NonMaxSuppressionV4=u.asm.ka).apply(null,arguments)},u._NonMaxSuppressionV5=function(){return(u._NonMaxSuppressionV5=u.asm.la).apply(null,arguments)},u._NotEqual=function(){return(u._NotEqual=u.asm.ma).apply(null,arguments)},u._OneHot=function(){return(u._OneHot=u.asm.na).apply(null,arguments)},u._PadV2=function(){return(u._PadV2=u.asm.oa).apply(null,arguments)},u._Pow=function(){return(u._Pow=u.asm.pa).apply(null,arguments)},u._Prelu=function(){return(u._Prelu=u.asm.qa).apply(null,arguments)},u._Prod=function(){return(u._Prod=u.asm.ra).apply(null,arguments)},u._RealDiv=function(){return(u._RealDiv=u.asm.sa).apply(null,arguments)},u._Relu=function(){return(u._Relu=u.asm.ta).apply(null,arguments)},u._Relu6=function(){return(u._Relu6=u.asm.ua).apply(null,arguments)},u._ResizeBilinear=function(){return(u._ResizeBilinear=u.asm.va).apply(null,arguments)},u._Reverse=function(){return(u._Reverse=u.asm.wa).apply(null,arguments)},u._RotateWithOffset=function(){return(u._RotateWithOffset=u.asm.xa).apply(null,arguments)},u._Round=function(){return(u._Round=u.asm.ya).apply(null,arguments)},u._Rsqrt=function(){return(u._Rsqrt=u.asm.za).apply(null,arguments)},u._ScatterNd=function(){return(u._ScatterNd=u.asm.Aa).apply(null,arguments)},u._SelectV2=function(){return(u._SelectV2=u.asm.Ba).apply(null,arguments)},u._Sigmoid=function(){return(u._Sigmoid=u.asm.Ca).apply(null,arguments)},u._Sin=function(){return(u._Sin=u.asm.Da).apply(null,arguments)},u._Softmax=function(){return(u._Softmax=u.asm.Ea).apply(null,arguments)},u._Sqrt=function(){return(u._Sqrt=u.asm.Fa).apply(null,arguments)},u._Square=function(){return(u._Square=u.asm.Ga).apply(null,arguments)},u._SquaredDifference=function(){return(u._SquaredDifference=u.asm.Ha).apply(null,arguments)},u._Step=function(){return(u._Step=u.asm.Ia).apply(null,arguments)},u._StridedSlice=function(){return(u._StridedSlice=u.asm.Ja).apply(null,arguments)},u._Sub=function(){return(u._Sub=u.asm.Ka).apply(null,arguments)},u._Sum=function(){return(u._Sum=u.asm.La).apply(null,arguments)},u._Tan=function(){return(u._Tan=u.asm.Ma).apply(null,arguments)},u._Tanh=function(){return(u._Tanh=u.asm.Na).apply(null,arguments)},u._Tile=function(){return(u._Tile=u.asm.Oa).apply(null,arguments)},u._TopK=function(){return(u._TopK=u.asm.Pa).apply(null,arguments)},u._Transform=function(){return(u._Transform=u.asm.Qa).apply(null,arguments)},u._Transpose=function(){return(u._Transpose=u.asm.Ra).apply(null,arguments)},u.__FusedMatMul=function(){return(u.__FusedMatMul=u.asm.Sa).apply(null,arguments)},u._malloc=function(){return(u._malloc=u.asm.Ta).apply(null,arguments)},u._free=function(){return(u._free=u.asm.Ua).apply(null,arguments)},u.___errno_location=function(){return(Ne=u.___errno_location=u.asm.Va).apply(null,arguments)}),Fe=u.stackSave=function(){return(Fe=u.stackSave=u.asm.Wa).apply(null,arguments)},Te=u.stackRestore=function(){return(Te=u.stackRestore=u.asm.Xa).apply(null,arguments)},Oe=u.stackAlloc=function(){return(Oe=u.stackAlloc=u.asm.Ya).apply(null,arguments)};function Ce(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function De(e){function n(){Me||(Me=!0,u.calledRun=!0,S||($(),K(),t(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),X()))}Z>0||(G(),Z>0||(u.setStatus?(u.setStatus("Running..."),setTimeout((function(){setTimeout((function(){u.setStatus("")}),1),n()}),1)):n()))}if(u.cwrap=x,J=function e(){Me||De(),Me||(J=e)},u.run=De,u.preInit)for("function"==typeof u.preInit&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();return De(),e.ready});e.exports=s}));class pn extends t.KernelBackend{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(kn),In=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new t.DataStorage(this,t.engine())}write(e,t,n){const a={id:this.dataIdNextNumber++};return this.move(a,e,t,n,1),a}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){const n=t.util.now();e();return{kernelMs:t.util.now()-n}}move(e,n,a,r,s){const u=this.dataIdNextNumber++;if("string"===r){const t=n;return void this.dataIdMap.set(e,{id:u,stringBytes:t,shape:a,dtype:r,memoryOffset:null,refCount:s})}const i=t.util.sizeFromShape(a),o=i*t.util.bytesPerElement(r),c=this.wasm._malloc(o);this.dataIdMap.set(e,{id:u,memoryOffset:c,shape:a,dtype:r,refCount:s}),this.wasm.tfjs.registerTensor(u,i,c),null!=n&&this.wasm.HEAPU8.set(new Uint8Array(n.buffer,n.byteOffset,o),c)}async read(e){return this.readSync(e)}readSync(e){const{memoryOffset:n,dtype:a,shape:r,stringBytes:s}=this.dataIdMap.get(e);if("string"===a)return s;return function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}(this.wasm.HEAPU8.slice(n,n+t.util.sizeFromShape(r)*t.util.bytesPerElement(a)).buffer,a)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){const n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){if(this.dataIdMap.has(e)){return this.dataIdMap.get(e).refCount}return 0}incRef(e){const t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,n,a){let r;if(null==a)r=this.write(null,e,n);else{const s=this.dataIdNextNumber++;r={id:s},this.dataIdMap.set(r,{id:s,memoryOffset:a,shape:e,dtype:n,refCount:1});const u=t.util.sizeFromShape(e);this.wasm.tfjs.registerTensor(s,u,a)}return{dataId:r,shape:e,dtype:n}}typedArrayFromHeap({shape:e,dtype:n,dataId:a}){const r=this.wasm.HEAPU8.buffer,{memoryOffset:s}=this.dataIdMap.get(a),u=t.util.sizeFromShape(e);switch(n){case"float32":return new Float32Array(r,s,u);case"int32":return new Int32Array(r,s,u);case"bool":return new Uint8Array(r,s,u);default:throw new Error(`Unknown dtype ${n}`)}}}function fn(e,t,n){if(null!=bn)return bn;let a="tfjs-backend-wasm.wasm";return e&&t?a="tfjs-backend-wasm-threaded-simd.wasm":e&&(a="tfjs-backend-wasm-simd.wasm"),null!=_n&&null!=_n[a]?_n[a]:n+a}async function mn(){const[e,n]=await Promise.all([t.env().getAsync("WASM_HAS_SIMD_SUPPORT"),t.env().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise(((a,r)=>{const s={locateFile:(t,a)=>{if(t.endsWith(".worker.js")){const e=new Blob(['var Module={};function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;this.alert=threadAlert;Module["instantiateWasm"]=function(info,receiveInstance){var instance=new WebAssembly.Instance(Module["wasmModule"],info);Module["wasmModule"]=null;receiveInstance(instance);return instance.exports};function moduleLoaded(){}this.onmessage=function(e){try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module).then(function(instance){Module=instance;moduleLoaded()})}else if(e.data.cmd==="objectTransfer"){Module["PThread"].receiveObjectTransfer(e.data)}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,0,0);var max=e.data.stackBase;var top=e.data.stackBase+e.data.stackSize;Module["establishStackSpace"](top,max);Module["_emscripten_tls_init"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].setThreadStatus(Module["_pthread_self"](),1);try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(!Module["getNoExitRuntime"]())Module["PThread"].threadExit(result)}catch(ex){if(ex==="Canceled!"){Module["PThread"].threadCancel()}else if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["getNoExitRuntime"]()){}else{Module["PThread"].threadExit(ex.status)}}else{Module["PThread"].threadExit(-2);throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["PThread"].threadCancel()}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);throw ex}};if(typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string"){self={location:{href:__filename}};var onmessage=this.onmessage;var nodeWorkerThreads=require("worker_threads");global.Worker=nodeWorkerThreads.Worker;var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",function(data){onmessage({data:data})});var nodeFS=require("fs");var nodeRead=function(filename){return nodeFS.readFileSync(filename,"utf8")};function globalEval(x){global.require=require;global.Module=Module;eval.call(null,x)}importScripts=function(f){globalEval(nodeRead(f))};postMessage=function(msg){parentPort.postMessage(msg)};if(typeof performance==="undefined"){performance={now:function(){return Date.now()}}}}'],{type:"application/javascript"});return URL.createObjectURL(e)}return t.endsWith(".wasm")?fn(e,n,null!=yn?yn:a):a+t}};wn&&(s.instantiateWasm=function(e){return(n,a)=>(t.util.fetch(e,{credentials:"same-origin"}).then((t=>{t.ok||n.env.a(`failed to load wasm binary file at '${e}'`),t.arrayBuffer().then((e=>{WebAssembly.instantiate(e,n).then((e=>{a(e.instance,e.module)}))}))})),{})}(fn(e,n,null!=yn?yn:"")));let u,i=!1;s.onAbort=()=>{if(i)return;if(gn)return;gn=!0;r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"})},n&&e&&null==bn?(s.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+ln.toString()],{type:"text/javascript"}),u=ln(s)):u=dn(s),u.then((e=>{i=!0,gn=!1;e.tfjs={init:e.cwrap("init",null,[]),initWithThreadsCount:e.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:e.cwrap("get_threads_count","number",[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},a({wasm:e})}))}))}const hn=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"];let bn=null,yn=null,_n={},gn=!1,wn=!1;let kn=-1,In=-1;t.registerBackend("wasm",(async()=>{const{wasm:e}=await mn();return new pn(e)}),2),e.BackendWasm=pn,e.getThreadsCount=function(){if(-1===In)throw new Error("WASM backend not initialized.");return In},e.setThreadsCount=function(e){kn=e},e.setWasmPath=function(e,n=!1){if(t.deprecationWarn("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),gn)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");bn=e,wn=n},e.setWasmPaths=function(e,t=!1){if(gn)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)yn=e;else{_n=e;const t=hn.filter((e=>null==_n[e]));if(t.length>0)throw new Error(`There were no entries found for the following binaries: ${t.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}wn=t},e.version_wasm="3.11.0",Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tf-backend-wasm.es2017.min.js.map
